<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to gllvm Part 1: Ordination • gllvm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to gllvm Part 1: Ordination">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gllvm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette1.html">Analysing multivariate abundance data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette2.html">Analysing high-dimensional microbial community data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette3.html">Introduction to gllvm Part 1: Ordination</a>
    </li>
    <li>
      <a href="../articles/vignette4.html">Introduction to gllvm Part 2: Species correlations</a>
    </li>
    <li>
      <a href="../articles/vignette5.html">How to use the quadratic response model</a>
    </li>
    <li>
      <a href="../articles/vignette6.html">Ordination with predictors</a>
    </li>
    <li>
      <a href="../articles/vignette7.html">Phylogenetic random effects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JenniNiku/gllvm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to gllvm Part 1: Ordination</h1>
                        <h4 data-toc-skip class="author">Jenni Niku</h4>
            
            <h4 data-toc-skip class="date">2024-08-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JenniNiku/gllvm/blob/HEAD/vignettes/vignette3.rmd" class="external-link"><code>vignettes/vignette3.rmd</code></a></small>
      <div class="hidden name"><code>vignette3.rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction-to-gllvm">Introduction to gllvm<a class="anchor" aria-label="anchor" href="#introduction-to-gllvm"></a>
</h2>
<div class="section level3">
<h3 id="r-package-gllvm">R package gllvm<a class="anchor" aria-label="anchor" href="#r-package-gllvm"></a>
</h3>
<ul>
<li><p><strong>R</strong> package <strong>gllvm</strong> fits
Generalized linear latent variable models (GLLVM) for multivariate
data<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p></li>
<li><p>Developed by J. Niku, W.Brooks, R. Herliansyah, F.K.C. Hui, S.
Taskinen, D.I. Warton, B. van der Veen.</p></li>
<li>
<p>The package available in</p>
<ul>
<li>GitHub: <a href="https://github.com/JenniNiku/gllvm" class="external-link uri">https://github.com/JenniNiku/gllvm</a>
</li>
<li>CRAN: <a href="https://CRAN.R-project.org/package=gllvm" class="external-link uri">https://CRAN.R-project.org/package=gllvm</a>
</li>
</ul>
</li>
<li><p>Package installation:</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From CRAN</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">gllvm</span><span class="op">)</span></span>
<span><span class="co"># OR</span></span>
<span><span class="co"># From GitHub using devtools package's function install_github</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"JenniNiku/gllvm"</span><span class="op">)</span></span></code></pre></div>
<details><summary><span style="color:red"> Problems? </span>
</summary><p><span style="color:red"> <strong>gllvm</strong> package depends on R
packages <strong>TMB</strong> and <strong>mvabund</strong>, try to
install these first.</span></p>
</details><ul>
<li><p>GLLVMs are computationally intensive to fit due the integral in
log-likelihood.</p></li>
<li><p><strong>gllvm</strong> package overcomes computational problems
by applying closed form approximations to log-likelihood and using
automatic differentiation in C++ to accelerate computation times
(<strong>TMB</strong><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>).</p></li>
<li><p>Estimation is performed using either variational approximation
(VA<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>),
extended variational approximation method (EVA<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>) or Laplace
approximation (LA<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>) method implemented via <strong>R</strong>
package <strong>TMB</strong>.</p></li>
<li><p>VA method is faster and more accurate than LA, but not applicable
for all distributions and link functions.</p></li>
<li>
<p>Using <strong>gllvm</strong> we can fit</p>
<ul>
<li>GLLVM without covariates gives model-based ordination and
biplots</li>
<li>GLLVM with environmental covariates for studying factors explaining
species abundance</li>
<li>Fourth corner models with latent variables for studying
environmental-trait interactions</li>
<li>GLLVM without latent variables fits basic multivariate GLMs</li>
</ul>
</li>
<li><p>Additional tools: model checking, model selection, inference,
visualization.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="distributions">Distributions<a class="anchor" aria-label="anchor" href="#distributions"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Response</th>
<th align="center">Distribution</th>
<th align="left">Method</th>
<th align="left">Link</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Counts</td>
<td align="center">Poisson</td>
<td align="left">VA/LA</td>
<td align="left">log</td>
</tr>
<tr class="even">
<td></td>
<td align="center">NB</td>
<td align="left">VA/LA</td>
<td align="left">log</td>
</tr>
<tr class="odd">
<td></td>
<td align="center">ZIP</td>
<td align="left">LA</td>
<td align="left">log</td>
</tr>
<tr class="even">
<td>Binary</td>
<td align="center">Bernoulli</td>
<td align="left">VA/LA</td>
<td align="left">probit</td>
</tr>
<tr class="odd">
<td></td>
<td align="center"></td>
<td align="left">EVA/LA</td>
<td align="left">logit</td>
</tr>
<tr class="even">
<td>Ordinal</td>
<td align="center">Ordinal</td>
<td align="left">VA</td>
<td align="left">probit</td>
</tr>
<tr class="odd">
<td>Normal</td>
<td align="center">Gaussian</td>
<td align="left">VA/LA</td>
<td align="left">identity</td>
</tr>
<tr class="even">
<td>Positive continuous</td>
<td align="center">Gamma</td>
<td align="left">VA/LA</td>
<td align="left">log</td>
</tr>
<tr class="odd">
<td>Non-negative continuous</td>
<td align="center">Exponential</td>
<td align="left">VA/LA</td>
<td align="left">log</td>
</tr>
<tr class="even">
<td>Biomass</td>
<td align="center">Tweedie</td>
<td align="left">LA/EVA</td>
<td align="left">log</td>
</tr>
<tr class="odd">
<td>Percent cover</td>
<td align="center">beta</td>
<td align="left">LA/EVA</td>
<td align="left">probit/logit</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="data-input">Data input<a class="anchor" aria-label="anchor" href="#data-input"></a>
</h3>
<p>Main function of the <strong>gllvm</strong> package is
<code><a href="../reference/gllvm.html">gllvm()</a></code>, which can be used to fit GLLVMs for multivariate
data with the most important arguments listed in the following:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span>, X <span class="op">=</span> <span class="cn">NULL</span>, TR <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">family</span>, num.lv <span class="op">=</span> <span class="fl">2</span>, </span>
<span> formula <span class="op">=</span> <span class="cn">NULL</span>, method <span class="op">=</span> <span class="st">"VA"</span>, row.eff <span class="op">=</span> <span class="cn">FALSE</span>, n.init<span class="op">=</span><span class="fl">1</span>, starting.val <span class="op">=</span><span class="st">"res"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>y: matrix of abundances</li>
<li>X: matrix or data.frame of environmental variables</li>
<li>TR: matrix or data.frame of trait variables</li>
<li>family: distribution for responses</li>
<li>num.lv: number of latent variables</li>
<li>method: approximation used “VA” or “LA”</li>
<li>row.eff: type of row effects</li>
<li>n.init: number of random starting points for latent variables</li>
<li>starting.val: starting value method</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jenniniku.github.io/gllvm/" class="external-link">gllvm</a></span><span class="op">)</span></span>
<span><span class="co">## Loading required package: TMB</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'gllvm'</span></span>
<span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     simulate</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-spiders">Example: Spiders<a class="anchor" aria-label="anchor" href="#example-spiders"></a>
</h3>
<ul>
<li>Abundances of 12 hunting spider species measured as a count at 28
sites<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>.</li>
<li>Six environmental variables measured at each site.
<ul>
<li>
<code>soil.dry</code>: Soil dry mass</li>
<li>
<code>bare.sand</code>: cover of bare sand</li>
<li>
<code>fallen.leaves</code>: cover of fallen leaves/twigs</li>
<li>
<code>moss</code>: cover of moss</li>
<li>
<code>herb.layer</code>: cover of herb layer</li>
<li>
<code>reflection</code>: reflection of the soil surface with a
cloudless sky</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="data-fitting">Data fitting<a class="anchor" aria-label="anchor" href="#data-fitting"></a>
</h3>
<p>Fitting basic GLLVM
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mrow><mn>0</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mi>′</mi><msub><mi>𝛉</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">g(E(y_{ij})) = \beta_{0j} + \boldsymbol{u}_i'\boldsymbol{\theta}_j</annotation></semantics></math>
with <strong>gllvm</strong>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spider"</span>, package <span class="op">=</span> <span class="st">"mvabund"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jenniniku.github.io/gllvm/" class="external-link">gllvm</a></span><span class="op">)</span></span>
<span><span class="va">fitnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fitnb</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = spider$abund, family = "negative.binomial", num.lv = 2)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "negative.binomial"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -733.6807 </span></span>
<span><span class="co">## Residual degrees of freedom:  289 </span></span>
<span><span class="co">## AIC:  1561.361 </span></span>
<span><span class="co">## AICc:  1577.028 </span></span>
<span><span class="co">## BIC:  1740.766</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="residual-analysis">Residual analysis<a class="anchor" aria-label="anchor" href="#residual-analysis"></a>
</h3>
<ul>
<li><p>Residual analysis can be used to assess the appropriateness of
the fitted model (eg. in terms of mean-variance relationship).</p></li>
<li><p>Randomized quantile/Dunn-Smyth residuals<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> are used in the
package, as they provide standard normal distributed residuals, even for
discrete responses, in the case of a proper model.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitnb</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette3_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="model-selection">Model selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h3>
<ul>
<li>Information criteria can be used for model selection.</li>
<li>For example, compare distributions or choose suitable number of
latent variables.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fitnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitp</span><span class="op">)</span></span>
<span><span class="co">## [1] 1761.655</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitnb</span><span class="op">)</span></span>
<span><span class="co">## [1] 1561.361</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<p>Try to do these exercises for the next 10 minutes, as many as time is
enough for.</p>
<p><span style="color:blue"> E1. Load spider data from
<strong>mvabund</strong> package and take a look at the dataset.
</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jenniniku.github.io/gllvm/" class="external-link">gllvm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spider"</span>, package <span class="op">=</span> <span class="st">"mvabund"</span><span class="op">)</span></span>
<span><span class="co"># more info: </span></span>
<span><span class="co"># ?spider</span></span></code></pre></div>
<details><summary><span style="color:red"> Show the answers. </span>
</summary><p><span style="color:red"> 1. Print the data and covariates and draw a
boxplot of the data. </span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># response matrix:</span></span>
<span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span></span>
<span><span class="co">##       Alopacce Alopcune Alopfabr Arctlute Arctperi Auloalbi Pardlugu Pardmont</span></span>
<span><span class="co">##  [1,]       25       10        0        0        0        4        0       60</span></span>
<span><span class="co">##  [2,]        0        2        0        0        0       30        1        1</span></span>
<span><span class="co">##  [3,]       15       20        2        2        0        9        1       29</span></span>
<span><span class="co">##  [4,]        2        6        0        1        0       24        1        7</span></span>
<span><span class="co">##  [5,]        1       20        0        2        0        9        1        2</span></span>
<span><span class="co">##  [6,]        0        6        0        6        0        6        0       11</span></span>
<span><span class="co">##  [7,]        2        7        0       12        0       16        1       30</span></span>
<span><span class="co">##  [8,]        0       11        0        0        0        7       55        2</span></span>
<span><span class="co">##  [9,]        1        1        0        0        0        0        0       26</span></span>
<span><span class="co">## [10,]        3        0        1        0        0        0        0       22</span></span>
<span><span class="co">## [11,]       15        1        2        0        0        1        0       95</span></span>
<span><span class="co">## [12,]       16       13        0        0        0        0        0       96</span></span>
<span><span class="co">## [13,]        3       43        1        2        0       18        1       24</span></span>
<span><span class="co">## [14,]        0        2        0        1        0        4        3       14</span></span>
<span><span class="co">## [15,]        0        0        0        0        0        0        6        0</span></span>
<span><span class="co">## [16,]        0        3        0        0        0        0        6        0</span></span>
<span><span class="co">## [17,]        0        0        0        0        0        0        2        0</span></span>
<span><span class="co">## [18,]        0        1        0        0        0        0        5        0</span></span>
<span><span class="co">## [19,]        0        1        0        0        0        0       12        0</span></span>
<span><span class="co">## [20,]        0        2        0        0        0        0       13        0</span></span>
<span><span class="co">## [21,]        0        1        0        0        0        0       16        1</span></span>
<span><span class="co">## [22,]        7        0       16        0        4        0        0        2</span></span>
<span><span class="co">## [23,]       17        0       15        0        7        0        2        6</span></span>
<span><span class="co">## [24,]       11        0       20        0        5        0        0        3</span></span>
<span><span class="co">## [25,]        9        1        9        0        0        2        1       11</span></span>
<span><span class="co">## [26,]        3        0        6        0       18        0        0        0</span></span>
<span><span class="co">## [27,]       29        0       11        0        4        0        0        1</span></span>
<span><span class="co">## [28,]       15        0       14        0        1        0        0        6</span></span>
<span><span class="co">##       Pardnigr Pardpull Trocterr Zoraspin</span></span>
<span><span class="co">##  [1,]       12       45       57        4</span></span>
<span><span class="co">##  [2,]       15       37       65        9</span></span>
<span><span class="co">##  [3,]       18       45       66        1</span></span>
<span><span class="co">##  [4,]       29       94       86       25</span></span>
<span><span class="co">##  [5,]      135       76       91       17</span></span>
<span><span class="co">##  [6,]       27       24       63       34</span></span>
<span><span class="co">##  [7,]       89      105      118       16</span></span>
<span><span class="co">##  [8,]        2        1       30        3</span></span>
<span><span class="co">##  [9,]        1        1        2        0</span></span>
<span><span class="co">## [10,]        0        0        1        0</span></span>
<span><span class="co">## [11,]        0        1        4        0</span></span>
<span><span class="co">## [12,]        1        8       13        0</span></span>
<span><span class="co">## [13,]       53       72       97       22</span></span>
<span><span class="co">## [14,]       15       72       94       32</span></span>
<span><span class="co">## [15,]        0        0       25        3</span></span>
<span><span class="co">## [16,]        2        0       28        4</span></span>
<span><span class="co">## [17,]        0        0       23        2</span></span>
<span><span class="co">## [18,]        0        0       25        0</span></span>
<span><span class="co">## [19,]        1        0       22        3</span></span>
<span><span class="co">## [20,]        0        0       22        2</span></span>
<span><span class="co">## [21,]        0        1       18        2</span></span>
<span><span class="co">## [22,]        0        0        1        0</span></span>
<span><span class="co">## [23,]        0        0        1        0</span></span>
<span><span class="co">## [24,]        0        0        0        0</span></span>
<span><span class="co">## [25,]        6        0       16        6</span></span>
<span><span class="co">## [26,]        0        0        1        0</span></span>
<span><span class="co">## [27,]        0        0        0        0</span></span>
<span><span class="co">## [28,]        0        0        2        0</span></span>
<span><span class="co"># Environmental variables</span></span>
<span><span class="va">spider</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="co">##    soil.dry bare.sand fallen.leaves   moss herb.layer reflection</span></span>
<span><span class="co">## 1    2.3321    0.0000        0.0000 3.0445     4.4543     3.9120</span></span>
<span><span class="co">## 2    3.0493    0.0000        1.7918 1.0986     4.5643     1.6094</span></span>
<span><span class="co">## 3    2.5572    0.0000        0.0000 2.3979     4.6052     3.6889</span></span>
<span><span class="co">## 4    2.6741    0.0000        0.0000 2.3979     4.6151     2.9957</span></span>
<span><span class="co">## 5    3.0155    0.0000        0.0000 0.0000     4.6151     2.3026</span></span>
<span><span class="co">## 6    3.3810    2.3979        3.4340 2.3979     3.4340     0.6931</span></span>
<span><span class="co">## 7    3.1781    0.0000        0.0000 0.6931     4.6151     2.3026</span></span>
<span><span class="co">## 8    2.6247    0.0000        4.2627 1.0986     3.4340     0.6931</span></span>
<span><span class="co">## 9    2.4849    0.0000        0.0000 4.3307     3.2581     3.4012</span></span>
<span><span class="co">## 10   2.1972    3.9318        0.0000 3.4340     3.0445     3.6889</span></span>
<span><span class="co">## 11   2.2192    0.0000        0.0000 4.1109     3.7136     3.6889</span></span>
<span><span class="co">## 12   2.2925    0.0000        0.0000 3.8286     4.0254     3.6889</span></span>
<span><span class="co">## 13   3.5175    1.7918        1.7918 0.6931     4.5109     3.4012</span></span>
<span><span class="co">## 14   3.0865    0.0000        0.0000 1.7918     4.5643     1.0986</span></span>
<span><span class="co">## 15   3.2696    0.0000        4.3944 0.6931     3.0445     0.6931</span></span>
<span><span class="co">## 16   3.0301    0.0000        4.6052 0.6931     0.6931     0.0000</span></span>
<span><span class="co">## 17   3.3322    0.0000        4.4543 0.6931     3.0445     1.0986</span></span>
<span><span class="co">## 18   3.1224    0.0000        4.3944 0.0000     3.0445     1.0986</span></span>
<span><span class="co">## 19   2.9232    0.0000        4.5109 1.6094     1.6094     0.0000</span></span>
<span><span class="co">## 20   3.1091    0.0000        4.5951 0.6931     0.6931     0.0000</span></span>
<span><span class="co">## 21   2.9755    0.0000        4.5643 0.6931     1.7918     0.0000</span></span>
<span><span class="co">## 22   1.2528    3.2581        0.0000 4.3307     0.6931     3.9120</span></span>
<span><span class="co">## 23   1.1939    3.0445        0.0000 4.0254     3.2581     4.0943</span></span>
<span><span class="co">## 24   1.6487    3.2581        0.0000 4.0254     3.0445     4.0073</span></span>
<span><span class="co">## 25   1.8245    3.5835        0.0000 1.0986     4.1109     2.3026</span></span>
<span><span class="co">## 26   0.9933    4.5109        0.0000 1.7918     1.7918     4.3820</span></span>
<span><span class="co">## 27   0.9555    2.3979        0.0000 3.8286     3.4340     3.6889</span></span>
<span><span class="co">## 28   0.9555    3.4340        0.0000 3.7136     3.4340     3.6889</span></span>
<span><span class="co"># Plot data using boxplot:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">spider</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette3_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></p>
</details><p><span style="color:blue"> E2. Fit GLLVM to spider data with a
suitable distribution. Data consists of counts of spider
species.</span></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take a look at the function documentation for help: </span></span>
<span><span class="op">?</span><span class="va">gllvm</span></span></code></pre></div>
<details><summary><span style="color:red"> Show the answers. </span>
</summary><p><span style="color:red"> 2. Response variables in spider data are
counts, so Poisson, negative binomial and zero inflated Poisson are
possible. However, ZIP is implemented only with Laplace method, so it
need to be noticed, that if models are fitted with different methods
they can not be compared with information criteria. Let’s try just with
a Poisson and NB.</span> <span style="color:red"> <strong>NOTE
THAT</strong> the results may not be exactly the same as below, as the
initial values for each model fit are slightly different, so the results
may also differ slightly.</span></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a GLLVM to data</span></span>
<span><span class="va">fitp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fitp</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = spider$abund, family = poisson(), num.lv = 2)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "poisson"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -845.8277 </span></span>
<span><span class="co">## Residual degrees of freedom:  301 </span></span>
<span><span class="co">## AIC:  1761.655 </span></span>
<span><span class="co">## AICc:  1770.055 </span></span>
<span><span class="co">## BIC:  1895.254</span></span>
<span><span class="va">fitnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fitnb</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = spider$abund, family = "negative.binomial", num.lv = 2)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "negative.binomial"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -733.6807 </span></span>
<span><span class="co">## Residual degrees of freedom:  289 </span></span>
<span><span class="co">## AIC:  1561.361 </span></span>
<span><span class="co">## AICc:  1577.028 </span></span>
<span><span class="co">## BIC:  1740.766</span></span></code></pre></div>
<p>Based on AIC, NB distribution suits better. How about residual
analysis: <span style="color:red"> <strong>NOTE THAT</strong> The
package uses randomized quantile residuals so each time you plot the
residuals, they look a little different.</span></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a GLLVM to data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitp</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette3_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-2.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-3.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-4.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-5.png" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fitnb</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette3_files/figure-html/unnamed-chunk-11-6.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-7.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-8.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-9.png" width="480" style="display: block; margin: auto;"><img src="vignette3_files/figure-html/unnamed-chunk-11-10.png" width="480" style="display: block; margin: auto;"></p>
<p>You could do these comparisons with Laplace method as well, using the
code below, and it would give the same conclusion that NB distribution
suits best:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitLAp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"LA"</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fitLAnb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span>, method <span class="op">=</span> <span class="st">"LA"</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fitLAzip</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="st">"ZIP"</span>, method <span class="op">=</span> <span class="st">"LA"</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitLAp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitLAnb</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fitLAzip</span><span class="op">)</span></span></code></pre></div>
</details><p><span style="color:blue"> E3. Explore the fitted model. Where are the
estimates for parameters? What about predicted latent variables?
Standard errors?</span></p>
<details><summary><span style="color:red"> Show the answers. </span>
</summary><p><span style="color:red"> 3. Lets explore the fitted model:
</span></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitnb</span><span class="op">)</span></span>
<span><span class="co">## $Species.scores</span></span>
<span><span class="co">##                 LV1        LV2</span></span>
<span><span class="co">## Alopacce  1.0000000  0.0000000</span></span>
<span><span class="co">## Alopcune -0.2631740  1.0000000</span></span>
<span><span class="co">## Alopfabr  0.9012964 -0.4840078</span></span>
<span><span class="co">## Arctlute -0.7026951  2.0282163</span></span>
<span><span class="co">## Arctperi  0.5941041 -1.5893485</span></span>
<span><span class="co">## Auloalbi -0.6529384  1.5332130</span></span>
<span><span class="co">## Pardlugu -0.8880584 -0.0283346</span></span>
<span><span class="co">## Pardmont  0.7492841  0.5884815</span></span>
<span><span class="co">## Pardnigr -0.5748022  1.7798474</span></span>
<span><span class="co">## Pardpull -0.4149376  1.9481946</span></span>
<span><span class="co">## Trocterr -0.4693903  0.7878657</span></span>
<span><span class="co">## Zoraspin -0.6961561  1.1566005</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sigma.lv</span></span>
<span><span class="co">##      LV1      LV2 </span></span>
<span><span class="co">## 1.803892 1.828690 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Intercept</span></span>
<span><span class="co">##   Alopacce   Alopcune   Alopfabr   Arctlute   Arctperi   Auloalbi   Pardlugu </span></span>
<span><span class="co">##  0.7737550  0.5527384 -0.1428596 -3.5862506 -3.3681967 -0.7299217  0.3189523 </span></span>
<span><span class="co">##   Pardmont   Pardnigr   Pardpull   Trocterr   Zoraspin </span></span>
<span><span class="co">##  1.6255407 -0.2729636 -0.1332579  2.6566655  0.2477211 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $inv.phi</span></span>
<span><span class="co">##   Alopacce   Alopcune   Alopfabr   Arctlute   Arctperi   Auloalbi   Pardlugu </span></span>
<span><span class="co">##  1.3064181  1.4682482  0.7052467  0.8985537  2.3306414  1.5386146  1.1528918 </span></span>
<span><span class="co">##   Pardmont   Pardnigr   Pardpull   Trocterr   Zoraspin </span></span>
<span><span class="co">##  1.6180079  2.5401112  2.1949143 12.9753513  2.5724225 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $phi</span></span>
<span><span class="co">##  Alopacce  Alopcune  Alopfabr  Arctlute  Arctperi  Auloalbi  Pardlugu  Pardmont </span></span>
<span><span class="co">## 0.7654517 0.6810838 1.4179435 1.1128995 0.4290664 0.6499353 0.8673841 0.6180440 </span></span>
<span><span class="co">##  Pardnigr  Pardpull  Trocterr  Zoraspin </span></span>
<span><span class="co">## 0.3936835 0.4555987 0.0770692 0.3887386</span></span>
<span><span class="co"># Where are the predicted latent variable values? just fitp$lvs or</span></span>
<span><span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">fitnb</span><span class="op">)</span></span>
<span><span class="co">##              LV1           LV2</span></span>
<span><span class="co">## Row1   0.9280716  1.2703921608</span></span>
<span><span class="co">## Row2  -0.6833799  0.7931112996</span></span>
<span><span class="co">## Row3   0.6761008  1.2744024537</span></span>
<span><span class="co">## Row4  -0.2474688  1.1495300096</span></span>
<span><span class="co">## Row5  -0.3612717  1.2169150843</span></span>
<span><span class="co">## Row6  -0.3523948  1.0083966313</span></span>
<span><span class="co">## Row7   0.0290453  1.4259839281</span></span>
<span><span class="co">## Row8  -1.5218059 -0.0718307843</span></span>
<span><span class="co">## Row9   0.9102994  0.0008130686</span></span>
<span><span class="co">## Row10  1.0371311 -0.4941576829</span></span>
<span><span class="co">## Row11  1.4890401  0.3029948635</span></span>
<span><span class="co">## Row12  1.3244847  0.8073754550</span></span>
<span><span class="co">## Row13  0.1153634  1.3565782725</span></span>
<span><span class="co">## Row14 -0.4371787  1.0141354167</span></span>
<span><span class="co">## Row15 -1.3193982 -0.5458435954</span></span>
<span><span class="co">## Row16 -1.1743660 -0.2435487204</span></span>
<span><span class="co">## Row17 -1.1130624 -0.5141217705</span></span>
<span><span class="co">## Row18 -1.1587204 -0.5439088158</span></span>
<span><span class="co">## Row19 -1.3405175 -0.5038367050</span></span>
<span><span class="co">## Row20 -1.3668834 -0.5930933717</span></span>
<span><span class="co">## Row21 -1.1394851 -0.4765512978</span></span>
<span><span class="co">## Row22  0.7642653 -1.3470526207</span></span>
<span><span class="co">## Row23  0.9210288 -1.3815121496</span></span>
<span><span class="co">## Row24  0.9791178 -1.3962675402</span></span>
<span><span class="co">## Row25  0.6313729  0.5764522986</span></span>
<span><span class="co">## Row26  0.2747960 -1.9652036873</span></span>
<span><span class="co">## Row27  1.1157439 -1.3103619005</span></span>
<span><span class="co">## Row28  1.0192948 -0.8263728575</span></span>
<span><span class="co"># Standard errors for parameters:</span></span>
<span><span class="va">fitnb</span><span class="op">$</span><span class="va">sd</span></span>
<span><span class="co">## $theta</span></span>
<span><span class="co">##                LV1       LV2</span></span>
<span><span class="co">## Alopacce 0.0000000 0.0000000</span></span>
<span><span class="co">## Alopcune 0.2733177 0.0000000</span></span>
<span><span class="co">## Alopfabr 0.3298680 0.2043612</span></span>
<span><span class="co">## Arctlute 0.6735202 0.7836738</span></span>
<span><span class="co">## Arctperi 0.4752967 0.5592892</span></span>
<span><span class="co">## Auloalbi 0.4402796 0.3893924</span></span>
<span><span class="co">## Pardlugu 0.2273684 0.2004821</span></span>
<span><span class="co">## Pardmont 0.2195966 0.1816528</span></span>
<span><span class="co">## Pardnigr 0.4727799 0.3799419</span></span>
<span><span class="co">## Pardpull 0.4960265 0.4108329</span></span>
<span><span class="co">## Trocterr 0.2095264 0.1569012</span></span>
<span><span class="co">## Zoraspin 0.3474686 0.2796226</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sigma.lv</span></span>
<span><span class="co">##       LV1       LV2 </span></span>
<span><span class="co">## 0.4163533 0.4258952 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $beta0</span></span>
<span><span class="co">##  Alopacce  Alopcune  Alopfabr  Arctlute  Arctperi  Auloalbi  Pardlugu  Pardmont </span></span>
<span><span class="co">## 0.4519226 0.4628608 0.5478520 1.7071988 1.4653249 0.7891611 0.4390375 0.3995752 </span></span>
<span><span class="co">##  Pardnigr  Pardpull  Trocterr  Zoraspin </span></span>
<span><span class="co">## 0.7865322 0.8338770 0.3337800 0.5826921 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $inv.phi</span></span>
<span><span class="co">##  Alopacce  Alopcune  Alopfabr  Arctlute  Arctperi  Auloalbi  Pardlugu  Pardmont </span></span>
<span><span class="co">## 0.6026260 0.6024449 0.3958156 0.5792937 1.8032183 0.8380663 0.5810814 0.7757222 </span></span>
<span><span class="co">##  Pardnigr  Pardpull  Trocterr  Zoraspin </span></span>
<span><span class="co">## 1.3144387 1.2462689 6.8906501 1.2848468 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $phi</span></span>
<span><span class="co">##   Alopacce   Alopcune   Alopfabr   Arctlute   Arctperi   Auloalbi   Pardlugu </span></span>
<span><span class="co">## 0.35308842 0.27945917 0.79581245 0.71748153 0.33196891 0.35401255 0.43717961 </span></span>
<span><span class="co">##   Pardmont   Pardnigr   Pardpull   Trocterr   Zoraspin </span></span>
<span><span class="co">## 0.29630908 0.20372057 0.25868821 0.04092813 0.19416313</span></span></code></pre></div>
</details><p><span style="color:blue"> E4. Fit model with different numbers of
latent variables.</span></p>
<details><summary><span style="color:red"> Show the answers. </span>
</summary><p><span style="color:red"> 4. Default number of latent variables is 2.
Let’s try 1 and 3 latent variables as well: </span></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># In exercise 2, we fitted GLLVM with two latent variables </span></span>
<span><span class="va">fitnb</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = spider$abund, family = "negative.binomial", num.lv = 2)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "negative.binomial"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -733.6807 </span></span>
<span><span class="co">## Residual degrees of freedom:  289 </span></span>
<span><span class="co">## AIC:  1561.361 </span></span>
<span><span class="co">## AICc:  1577.028 </span></span>
<span><span class="co">## BIC:  1740.766</span></span>
<span><span class="co"># How about 1 or 3 LVs</span></span>
<span><span class="va">fitnb1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span>, num.lv <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fitnb1</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = spider$abund, family = "negative.binomial", num.lv = 1)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "negative.binomial"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -759.4012 </span></span>
<span><span class="co">## Residual degrees of freedom:  300 </span></span>
<span><span class="co">## AIC:  1590.802 </span></span>
<span><span class="co">## AICc:  1599.712 </span></span>
<span><span class="co">## BIC:  1728.218</span></span>
<span><span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">fitnb1</span><span class="op">)</span></span>
<span><span class="co">##               LV1</span></span>
<span><span class="co">## Row1  -0.81676413</span></span>
<span><span class="co">## Row2  -0.94960125</span></span>
<span><span class="co">## Row3  -0.91681940</span></span>
<span><span class="co">## Row4  -1.10568473</span></span>
<span><span class="co">## Row5  -1.22144979</span></span>
<span><span class="co">## Row6  -1.03398484</span></span>
<span><span class="co">## Row7  -1.26767644</span></span>
<span><span class="co">## Row8  -0.53478360</span></span>
<span><span class="co">## Row9   0.36592898</span></span>
<span><span class="co">## Row10  1.00877957</span></span>
<span><span class="co">## Row11  0.31276001</span></span>
<span><span class="co">## Row12 -0.31676991</span></span>
<span><span class="co">## Row13 -1.17619313</span></span>
<span><span class="co">## Row14 -1.03496933</span></span>
<span><span class="co">## Row15 -0.09008794</span></span>
<span><span class="co">## Row16 -0.27458309</span></span>
<span><span class="co">## Row17 -0.02447396</span></span>
<span><span class="co">## Row18 -0.02079744</span></span>
<span><span class="co">## Row19 -0.12968909</span></span>
<span><span class="co">## Row20 -0.06889017</span></span>
<span><span class="co">## Row21 -0.04324447</span></span>
<span><span class="co">## Row22  1.54068229</span></span>
<span><span class="co">## Row23  1.65008583</span></span>
<span><span class="co">## Row24  1.68364476</span></span>
<span><span class="co">## Row25 -0.28906403</span></span>
<span><span class="co">## Row26  1.92897385</span></span>
<span><span class="co">## Row27  1.62325289</span></span>
<span><span class="co">## Row28  1.20009416</span></span>
<span><span class="va">fitnb3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span>, num.lv <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">fitnb3</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = spider$abund, family = "negative.binomial", num.lv = 3)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "negative.binomial"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -733.6807 </span></span>
<span><span class="co">## Residual degrees of freedom:  279 </span></span>
<span><span class="co">## AIC:  1581.361 </span></span>
<span><span class="co">## AICc:  1605.146 </span></span>
<span><span class="co">## BIC:  1798.937</span></span>
<span><span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">fitnb3</span><span class="op">)</span></span>
<span><span class="co">##               LV1           LV2           LV3</span></span>
<span><span class="co">## Row1   0.92855997  1.2704066937  2.490147e-04</span></span>
<span><span class="co">## Row2  -0.68289382  0.7936434946 -4.250590e-04</span></span>
<span><span class="co">## Row3   0.67654263  1.2745071649  2.713419e-04</span></span>
<span><span class="co">## Row4  -0.24684270  1.1500860175  3.801664e-05</span></span>
<span><span class="co">## Row5  -0.36042112  1.2176476998  5.541020e-04</span></span>
<span><span class="co">## Row6  -0.35190586  1.0088261019  1.163737e-03</span></span>
<span><span class="co">## Row7   0.03029708  1.4267390069  1.056439e-03</span></span>
<span><span class="co">## Row8  -1.52100704 -0.0710999886 -2.349148e-03</span></span>
<span><span class="co">## Row9   0.91092628 -0.0002631222 -2.949115e-04</span></span>
<span><span class="co">## Row10  1.03719421 -0.4947825169 -3.210705e-04</span></span>
<span><span class="co">## Row11  1.48909850  0.3020168483 -4.614553e-04</span></span>
<span><span class="co">## Row12  1.32431104  0.8068430042 -7.479638e-04</span></span>
<span><span class="co">## Row13  0.11566140  1.3569379287 -1.993838e-04</span></span>
<span><span class="co">## Row14 -0.43645442  1.0147814740  2.241292e-04</span></span>
<span><span class="co">## Row15 -1.31860748 -0.5455602127  4.306928e-04</span></span>
<span><span class="co">## Row16 -1.17474725 -0.2435589343  1.754225e-04</span></span>
<span><span class="co">## Row17 -1.11197409 -0.5137065542  5.233045e-04</span></span>
<span><span class="co">## Row18 -1.15819895 -0.5438243299  3.008523e-04</span></span>
<span><span class="co">## Row19 -1.34038762 -0.5036427180  1.120733e-04</span></span>
<span><span class="co">## Row20 -1.36657978 -0.5927568262 -1.113443e-04</span></span>
<span><span class="co">## Row21 -1.13970938 -0.4766759052 -3.724385e-04</span></span>
<span><span class="co">## Row22  0.76499682 -1.3477413239  5.881954e-05</span></span>
<span><span class="co">## Row23  0.92092061 -1.3819481717 -5.979814e-04</span></span>
<span><span class="co">## Row24  0.97910691 -1.3962196048 -6.646905e-05</span></span>
<span><span class="co">## Row25  0.63223200  0.5766255674  7.922041e-04</span></span>
<span><span class="co">## Row26  0.27486244 -1.9659703788 -4.974432e-05</span></span>
<span><span class="co">## Row27  1.11558856 -1.3109958578 -7.057136e-05</span></span>
<span><span class="co">## Row28  1.01937654 -0.8279080554  1.168999e-04</span></span></code></pre></div>
</details><p><span style="color:blue"> E5. Include environmental variables to the
GLLVM and explore the model fit. </span></p>
<details><summary><span style="color:red"> Show the answers. </span>
</summary><p><span style="color:red"> 5. Environmental variables can be included
with an argument <code>X</code>: </span></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fitnbx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span>, X <span class="op">=</span> <span class="va">spider</span><span class="op">$</span><span class="va">x</span>, family <span class="op">=</span> <span class="st">"negative.binomial"</span>, seed <span class="op">=</span> <span class="fl">123</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">fitnbx</span></span>
<span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = spider$abund, X = spider$x, family = "negative.binomial", </span></span>
<span><span class="co">##     num.lv = 2, seed = 123)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "negative.binomial"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -593.6749 </span></span>
<span><span class="co">## Residual degrees of freedom:  217 </span></span>
<span><span class="co">## AIC:  1425.35 </span></span>
<span><span class="co">## AICc:  1557.572 </span></span>
<span><span class="co">## BIC:  1879.586</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitnbx</span><span class="op">)</span></span>
<span><span class="co">## $Species.scores</span></span>
<span><span class="co">##                  LV1          LV2</span></span>
<span><span class="co">## Alopacce  1.00000000 0.000000e+00</span></span>
<span><span class="co">## Alopcune  0.68916865 1.000000e+00</span></span>
<span><span class="co">## Alopfabr  1.90230921 5.840783e-01</span></span>
<span><span class="co">## Arctlute -1.38607161 1.151995e+00</span></span>
<span><span class="co">## Arctperi  1.22521484 2.221633e-07</span></span>
<span><span class="co">## Auloalbi -0.92020468 6.094261e-01</span></span>
<span><span class="co">## Pardlugu -7.48597694 1.962680e-01</span></span>
<span><span class="co">## Pardmont  1.96603908 3.640805e-01</span></span>
<span><span class="co">## Pardnigr -0.01879616 1.070834e+00</span></span>
<span><span class="co">## Pardpull  0.88533829 7.282082e-01</span></span>
<span><span class="co">## Trocterr -2.07163094 4.991174e-01</span></span>
<span><span class="co">## Zoraspin  0.56158756 7.372882e-01</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $sigma.lv</span></span>
<span><span class="co">##          LV1          LV2 </span></span>
<span><span class="co">## 3.687855e-09 9.498144e-01 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Intercept</span></span>
<span><span class="co">##    Alopacce    Alopcune    Alopfabr    Arctlute    Arctperi    Auloalbi </span></span>
<span><span class="co">##  -1.8103258  -4.4224956  -1.6449944 -14.7087863 -14.9169422 -15.7133769 </span></span>
<span><span class="co">##    Pardlugu    Pardmont    Pardnigr    Pardpull    Trocterr    Zoraspin </span></span>
<span><span class="co">##   7.9301258  -6.3823114  -5.1520421 -13.0271594  -0.2002455  -3.8439096 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Xcoef</span></span>
<span><span class="co">##            soil.dry   bare.sand fallen.leaves        moss  herb.layer</span></span>
<span><span class="co">## Alopacce -0.9582511 -0.09057874   -0.32434977  0.10119394  0.73701108</span></span>
<span><span class="co">## Alopcune  1.3489514 -0.45003345    0.01722427 -0.19944566  0.41934286</span></span>
<span><span class="co">## Alopfabr -0.8696598  0.69567983   -0.40323378  0.54011145  0.30201315</span></span>
<span><span class="co">## Arctlute  5.8761487  0.16509176   -1.67138081  0.34428001 -0.12241502</span></span>
<span><span class="co">## Arctperi -1.7801351  0.23861596   -1.69351634  0.49613942  0.02134135</span></span>
<span><span class="co">## Auloalbi  0.2247558 -0.04624476    0.62851090  0.06258001  4.05105732</span></span>
<span><span class="co">## Pardlugu -2.5228614 -0.71522834    0.36225552 -0.37414127  0.58631700</span></span>
<span><span class="co">## Pardmont  1.5853955  0.13333086   -0.51419130  0.88748577  0.73439762</span></span>
<span><span class="co">## Pardnigr  2.5562596 -0.02655768   -0.84839330 -0.45639109  0.72847214</span></span>
<span><span class="co">## Pardpull  3.0006099 -0.35240495   -0.47040439  0.36472207  1.95126165</span></span>
<span><span class="co">## Trocterr  1.2400003 -0.23011461   -0.22750274 -0.20327073  0.44578023</span></span>
<span><span class="co">## Zoraspin  2.0997883  0.11999950   -0.57216254 -0.09001501  0.61990264</span></span>
<span><span class="co">##           reflection</span></span>
<span><span class="co">## Alopacce  0.86919998</span></span>
<span><span class="co">## Alopcune  0.42097019</span></span>
<span><span class="co">## Alopfabr  0.06169176</span></span>
<span><span class="co">## Arctlute -0.64295399</span></span>
<span><span class="co">## Arctperi  4.00808365</span></span>
<span><span class="co">## Auloalbi -0.54353969</span></span>
<span><span class="co">## Pardlugu -1.16951267</span></span>
<span><span class="co">## Pardmont  0.07825232</span></span>
<span><span class="co">## Pardnigr -0.53379124</span></span>
<span><span class="co">## Pardpull -0.36808575</span></span>
<span><span class="co">## Trocterr -0.29459296</span></span>
<span><span class="co">## Zoraspin -0.93163555</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $inv.phi</span></span>
<span><span class="co">##     Alopacce     Alopcune     Alopfabr     Arctlute     Arctperi     Auloalbi </span></span>
<span><span class="co">## 9.150533e+00 2.937638e+00 7.754711e+00 2.021987e+00 3.305834e+06 1.022689e+01 </span></span>
<span><span class="co">##     Pardlugu     Pardmont     Pardnigr     Pardpull     Trocterr     Zoraspin </span></span>
<span><span class="co">## 2.767426e+01 1.990657e+00 7.670150e+00 1.667425e+01 2.642531e+01 6.320589e+00 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $phi</span></span>
<span><span class="co">##     Alopacce     Alopcune     Alopfabr     Arctlute     Arctperi     Auloalbi </span></span>
<span><span class="co">## 1.092833e-01 3.404095e-01 1.289539e-01 4.945630e-01 3.024955e-07 9.778140e-02 </span></span>
<span><span class="co">##     Pardlugu     Pardmont     Pardnigr     Pardpull     Trocterr     Zoraspin </span></span>
<span><span class="co">## 3.613466e-02 5.023468e-01 1.303756e-01 5.997270e-02 3.784251e-02 1.582131e-01</span></span>
<span><span class="co"># confidence intervals for parameters:</span></span>
<span><span class="fu"><a href="../reference/confint.gllvm.html">confint</a></span><span class="op">(</span><span class="va">fitnbx</span><span class="op">)</span></span>
<span><span class="co">##                                      2.5 %        97.5 %</span></span>
<span><span class="co">## sigma.lv.LV1                 -3.451372e-07  3.525129e-07</span></span>
<span><span class="co">## sigma.lv.LV2                  4.335838e-01  1.466045e+00</span></span>
<span><span class="co">## theta.LV1.1                   1.000000e+00  1.000000e+00</span></span>
<span><span class="co">## theta.LV1.2                  -1.661256e+08  1.661256e+08</span></span>
<span><span class="co">## theta.LV1.3                  -6.382534e+07  6.382535e+07</span></span>
<span><span class="co">## theta.LV1.4                  -1.515045e+08  1.515045e+08</span></span>
<span><span class="co">## theta.LV1.5                  -5.527129e+04  5.527374e+04</span></span>
<span><span class="co">## theta.LV1.6                  -8.368435e+07  8.368435e+07</span></span>
<span><span class="co">## theta.LV1.7                  -3.365452e+07  3.365450e+07</span></span>
<span><span class="co">## theta.LV1.8                  -1.354546e+08  1.354546e+08</span></span>
<span><span class="co">## theta.LV1.9                  -1.290666e+08  1.290666e+08</span></span>
<span><span class="co">## theta.LV1.10                 -8.489715e+07  8.489715e+07</span></span>
<span><span class="co">## theta.LV1.11                 -5.482856e+07  5.482855e+07</span></span>
<span><span class="co">## theta.LV1.12                 -9.553078e+07  9.553078e+07</span></span>
<span><span class="co">## theta.LV2.1                   0.000000e+00  0.000000e+00</span></span>
<span><span class="co">## theta.LV2.2                   1.000000e+00  1.000000e+00</span></span>
<span><span class="co">## theta.LV2.3                  -5.160433e-02  1.219761e+00</span></span>
<span><span class="co">## theta.LV2.4                  -1.947999e-01  2.498789e+00</span></span>
<span><span class="co">## theta.LV2.5                  -1.340877e-03  1.341322e-03</span></span>
<span><span class="co">## theta.LV2.6                   5.410661e-02  1.164746e+00</span></span>
<span><span class="co">## theta.LV2.7                  -1.284725e-01  5.210085e-01</span></span>
<span><span class="co">## theta.LV2.8                  -1.511917e-01  8.793528e-01</span></span>
<span><span class="co">## theta.LV2.9                   4.317165e-01  1.709952e+00</span></span>
<span><span class="co">## theta.LV2.10                  2.700789e-01  1.186337e+00</span></span>
<span><span class="co">## Intercept.Alopacce            2.335938e-01  7.646411e-01</span></span>
<span><span class="co">## Intercept.Alopcune            2.324695e-01  1.242107e+00</span></span>
<span><span class="co">## Intercept.Alopfabr           -5.313699e+00  1.693047e+00</span></span>
<span><span class="co">## Intercept.Arctlute           -9.575870e+00  7.308788e-01</span></span>
<span><span class="co">## Intercept.Arctperi           -7.970829e+00  4.680840e+00</span></span>
<span><span class="co">## Intercept.Auloalbi           -3.139483e+01  1.977255e+00</span></span>
<span><span class="co">## Intercept.Pardlugu           -2.631109e+01 -3.522795e+00</span></span>
<span><span class="co">## Intercept.Pardmont           -2.247287e+01 -8.953885e+00</span></span>
<span><span class="co">## Intercept.Pardnigr            3.192771e+00  1.266748e+01</span></span>
<span><span class="co">## Intercept.Pardpull           -1.043372e+01 -2.330902e+00</span></span>
<span><span class="co">## Intercept.Trocterr           -1.019811e+01 -1.059777e-01</span></span>
<span><span class="co">## Intercept.Zoraspin           -1.860684e+01 -7.447482e+00</span></span>
<span><span class="co">## Xcoef.soil.dry:Alopacce      -2.429679e+00  2.029188e+00</span></span>
<span><span class="co">## Xcoef.soil.dry:Alopcune      -7.699494e+00  1.167434e-02</span></span>
<span><span class="co">## Xcoef.soil.dry:Alopfabr      -1.627927e+00 -2.885756e-01</span></span>
<span><span class="co">## Xcoef.soil.dry:Arctlute      -1.661170e-01  2.864020e+00</span></span>
<span><span class="co">## Xcoef.soil.dry:Arctperi      -1.961612e+00  2.222920e-01</span></span>
<span><span class="co">## Xcoef.soil.dry:Auloalbi       4.199697e-01  1.133233e+01</span></span>
<span><span class="co">## Xcoef.soil.dry:Pardlugu      -3.435499e+00 -1.247711e-01</span></span>
<span><span class="co">## Xcoef.soil.dry:Pardmont      -9.613210e-01  1.410833e+00</span></span>
<span><span class="co">## Xcoef.soil.dry:Pardnigr      -3.775452e+00 -1.270271e+00</span></span>
<span><span class="co">## Xcoef.soil.dry:Pardpull       6.324956e-01  2.538295e+00</span></span>
<span><span class="co">## Xcoef.soil.dry:Trocterr       1.053123e+00  4.059397e+00</span></span>
<span><span class="co">## Xcoef.soil.dry:Zoraspin       1.556240e+00  4.444980e+00</span></span>
<span><span class="co">## Xcoef.bare.sand:Alopacce      5.868953e-01  1.893105e+00</span></span>
<span><span class="co">## Xcoef.bare.sand:Alopcune      9.197435e-01  3.279833e+00</span></span>
<span><span class="co">## Xcoef.bare.sand:Alopfabr     -3.852455e-01  2.040880e-01</span></span>
<span><span class="co">## Xcoef.bare.sand:Arctlute     -9.737967e-01  7.372977e-02</span></span>
<span><span class="co">## Xcoef.bare.sand:Arctperi      1.976568e-01  1.193703e+00</span></span>
<span><span class="co">## Xcoef.bare.sand:Auloalbi     -1.535374e+00  1.865558e+00</span></span>
<span><span class="co">## Xcoef.bare.sand:Pardlugu     -6.816607e-01  1.158893e+00</span></span>
<span><span class="co">## Xcoef.bare.sand:Pardmont     -4.621246e-01  3.696351e-01</span></span>
<span><span class="co">## Xcoef.bare.sand:Pardnigr     -1.247968e+00 -1.824892e-01</span></span>
<span><span class="co">## Xcoef.bare.sand:Pardpull     -1.851530e-01  4.518147e-01</span></span>
<span><span class="co">## Xcoef.bare.sand:Trocterr     -5.132411e-01  4.601257e-01</span></span>
<span><span class="co">## Xcoef.bare.sand:Zoraspin     -8.536074e-01  1.487975e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Alopacce -4.442612e-01 -1.596807e-02</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Alopcune -2.625495e-01  5.025485e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Alopfabr -9.897089e-01  3.410094e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Arctlute -5.798387e-01  6.142872e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Arctperi -1.537080e+00  7.306126e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Auloalbi -3.797199e+00  4.544379e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Pardlugu -1.422636e+02  1.388766e+02</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Pardmont  1.123849e-01  1.144637e+00</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Pardnigr  3.925601e-02  6.852550e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Pardpull -1.026709e+00 -1.673578e-03</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Trocterr -1.464779e+00 -2.320080e-01</span></span>
<span><span class="co">## Xcoef.fallen.leaves:Zoraspin -9.510341e-01  1.022531e-02</span></span>
<span><span class="co">## Xcoef.moss:Alopacce          -4.819898e-01  2.698433e-02</span></span>
<span><span class="co">## Xcoef.moss:Alopcune          -1.030344e+00 -1.139815e-01</span></span>
<span><span class="co">## Xcoef.moss:Alopfabr          -2.226356e-01  4.250235e-01</span></span>
<span><span class="co">## Xcoef.moss:Arctlute          -7.950942e-01  3.962029e-01</span></span>
<span><span class="co">## Xcoef.moss:Arctperi           1.280249e-02  1.067420e+00</span></span>
<span><span class="co">## Xcoef.moss:Auloalbi          -9.128461e-01  1.601406e+00</span></span>
<span><span class="co">## Xcoef.moss:Pardlugu          -1.219061e-01  1.114185e+00</span></span>
<span><span class="co">## Xcoef.moss:Pardmont          -4.179727e-01  5.431327e-01</span></span>
<span><span class="co">## Xcoef.moss:Pardnigr          -8.454137e-01  9.713116e-02</span></span>
<span><span class="co">## Xcoef.moss:Pardpull           4.274640e-01  1.347508e+00</span></span>
<span><span class="co">## Xcoef.moss:Trocterr          -1.039347e+00  1.265650e-01</span></span>
<span><span class="co">## Xcoef.moss:Zoraspin          -8.544885e-02  8.148930e-01</span></span>
<span><span class="co">## Xcoef.herb.layer:Alopacce    -4.720130e-01  6.547150e-02</span></span>
<span><span class="co">## Xcoef.herb.layer:Alopcune    -5.685658e-01  3.885358e-01</span></span>
<span><span class="co">## Xcoef.herb.layer:Alopfabr     3.371018e-01  1.136920e+00</span></span>
<span><span class="co">## Xcoef.herb.layer:Arctlute    -3.381100e-01  1.176796e+00</span></span>
<span><span class="co">## Xcoef.herb.layer:Arctperi    -2.707937e-01  8.748200e-01</span></span>
<span><span class="co">## Xcoef.herb.layer:Auloalbi    -3.061406e+00  2.816575e+00</span></span>
<span><span class="co">## Xcoef.herb.layer:Pardlugu    -4.105781e-01  4.532608e-01</span></span>
<span><span class="co">## Xcoef.herb.layer:Pardmont     2.456802e+00  5.645312e+00</span></span>
<span><span class="co">## Xcoef.herb.layer:Pardnigr     2.739132e-01  8.987208e-01</span></span>
<span><span class="co">## Xcoef.herb.layer:Pardpull     4.677144e-02  1.422024e+00</span></span>
<span><span class="co">## Xcoef.herb.layer:Trocterr    -1.338484e-01  1.590793e+00</span></span>
<span><span class="co">## Xcoef.herb.layer:Zoraspin     9.272155e-01  2.975308e+00</span></span>
<span><span class="co">## Xcoef.reflection:Alopacce     1.165233e-01  7.750372e-01</span></span>
<span><span class="co">## Xcoef.reflection:Alopcune    -1.620861e-02  1.256014e+00</span></span>
<span><span class="co">## Xcoef.reflection:Alopfabr     3.389411e-01  1.399459e+00</span></span>
<span><span class="co">## Xcoef.reflection:Arctlute    -3.763372e-01  1.218278e+00</span></span>
<span><span class="co">## Xcoef.reflection:Arctperi    -9.860434e-01  1.109427e+00</span></span>
<span><span class="co">## Xcoef.reflection:Auloalbi    -1.930298e+00  6.443902e-01</span></span>
<span><span class="co">## Xcoef.reflection:Pardlugu     1.461811e+00  6.554356e+00</span></span>
<span><span class="co">## Xcoef.reflection:Pardmont    -1.141664e+00  5.458479e-02</span></span>
<span><span class="co">## Xcoef.reflection:Pardnigr    -1.807383e+00 -5.316420e-01</span></span>
<span><span class="co">## Xcoef.reflection:Pardpull    -5.106727e-01  6.671773e-01</span></span>
<span><span class="co">## Xcoef.reflection:Trocterr    -1.302887e+00  2.353045e-01</span></span>
<span><span class="co">## Xcoef.reflection:Zoraspin    -8.995360e-01  1.633645e-01</span></span>
<span><span class="co">## inv.phi.Alopacce             -6.349226e-01  4.573667e-02</span></span>
<span><span class="co">## inv.phi.Alopcune             -1.527984e+00 -3.352872e-01</span></span>
<span><span class="co">## inv.phi.Alopfabr             -1.057856e+01  2.887962e+01</span></span>
<span><span class="co">## inv.phi.Arctlute             -7.208618e-02  5.947362e+00</span></span>
<span><span class="co">## inv.phi.Arctperi             -8.209341e+00  2.371876e+01</span></span>
<span><span class="co">## inv.phi.Auloalbi             -1.057305e+00  5.101279e+00</span></span>
<span><span class="co">## inv.phi.Pardlugu             -3.331696e+09  3.338308e+09</span></span>
<span><span class="co">## inv.phi.Pardmont             -3.753970e+00  2.420776e+01</span></span>
<span><span class="co">## inv.phi.Pardnigr             -4.806425e+01  1.034128e+02</span></span>
<span><span class="co">## inv.phi.Pardpull              5.019648e-01  3.479348e+00</span></span>
<span><span class="co">## inv.phi.Trocterr             -1.345622e+00  1.668592e+01</span></span>
<span><span class="co">## inv.phi.Zoraspin             -4.387849e+00  3.773636e+01</span></span>
<span><span class="co">## inv.phi.Trocterr             -3.374158e+00  5.622477e+01</span></span>
<span><span class="co">## inv.phi.Zoraspin             -1.190730e+00  1.383191e+01</span></span></code></pre></div>
</details><details><summary><span style="color:red"> Problems? See hints:</span>
</summary><p><span style="color:red"> I have problems in model fitting. My model
converges to infinity or local maxima: </span> GLLVMs are complex models
where starting values have a big role. Choosing a different starting
value method (see argument <code>starting.val</code>) or use multiple
runs and pick up the one giving highest log-likelihood value using
argument <code>n.init</code>. More variation to the starting points can
be added with <code>jitter.var</code>.</p>
<p><span style="color:red"> My results does not look the same as in
answers:</span> The results may not be exactly the same as in the
answers, as the initial values for each model fit are slightly
different, so the results may also differ slightly.</p>
</details>
</div>
<div class="section level2">
<h2 id="ordination">Ordination<a class="anchor" aria-label="anchor" href="#ordination"></a>
</h2>
<div class="section level3">
<h3 id="gllvm-as-a-model-based-ordination-method">GLLVM as a model based ordination method<a class="anchor" aria-label="anchor" href="#gllvm-as-a-model-based-ordination-method"></a>
</h3>
<ul>
<li><p>GLLVMs can be used as a model-based approach to unconstrained
ordination by including two latent variables in the model:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mrow><mn>0</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mi>′</mi><msub><mi>𝛉</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">g(E(y_{ij})) = \beta_{0j} + \boldsymbol{u}_i'\boldsymbol{\theta}_j</annotation></semantics></math></p></li>
<li><p>The latent variable term try to capture the underlying factors
driving species abundances at sites.</p></li>
<li><p>Predictions for the two latent variables,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>𝐮</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>u</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><msub><mover><mi>u</mi><mo accent="true">̂</mo></mover><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\hat u}_i=(\hat u_{i1}, \hat u_{i2})</annotation></semantics></math>,
then provide coordinates for sites in the ordination plot and then
provides a graphical representation of which sites are similar in terms
of their species composition.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="ordination-plot">Ordination plot<a class="anchor" aria-label="anchor" href="#ordination-plot"></a>
</h3>
<ul>
<li>
<code><a href="../reference/ordiplot.gllvm.html">ordiplot()</a></code> produces ordination plots based on fitted
GLLVMs.</li>
<li>Uncertainty of the ordination points in model based ordination can
be assessed with prediction regions based on the prediction errors of
latent variables.</li>
<li>Prediction regions may also help interpreting which differences
between ordination points are really a sign of the difference between
species composition at those sites.</li>
</ul>
<p><img src="vignette3_files/figure-html/unnamed-chunk-16-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="biplot">Biplot<a class="anchor" aria-label="anchor" href="#biplot"></a>
</h3>
<ul>
<li>Between species correlations can be visualized with biplot<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> by adding
latent variable loadings
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛉</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\theta}_j</annotation></semantics></math>
to the ordination of sites, by producing a biplot, (argument
<code>biplot = TRUE</code> in <code><a href="../reference/ordiplot.gllvm.html">ordiplot()</a></code>).</li>
<li>In a biplot latent variables and their loadings are rotated so that
the LV loadings of the species are in the same direction with the sites
where they are most abundant.</li>
<li>Biplot can be used for finding groups of correlated species or
finding indicator species common at specific sites.</li>
<li>For example, species named Pardlugu is common in the group of sites
located on the bottom (eg sites 8, 19, 20 and 21).</li>
<li>x and y axes may help the interpretation.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ordiplot.gllvm.html">ordiplot</a></span><span class="op">(</span><span class="va">fitnb</span>, biplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, v <span class="op">=</span> <span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette3_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="environmental-gradients">Environmental gradients<a class="anchor" aria-label="anchor" href="#environmental-gradients"></a>
</h3>
<ul>
<li>The potential impact of environmental variables on species
communities can be viewed by coloring ordination points according to the
variables.</li>
<li>For example, species named Pardlugu seems to prefer sites with lot
of dry soil mass and low reflection of the soil surface with a cloudless
sky.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arbitrary color palette, a vector length of 20. Can use, for example, colorRampPalette from package grDevices</span></span>
<span><span class="va">rbPal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#00FA9A"</span>, <span class="st">"#00EC9F"</span>, <span class="st">"#00DFA4"</span>, <span class="st">"#00D2A9"</span>, <span class="st">"#00C5AF"</span>, <span class="st">"#00B8B4"</span>, <span class="st">"#00ABB9"</span>, <span class="st">"#009DBF"</span>, <span class="st">"#0090C4"</span>, <span class="st">"#0083C9"</span>, <span class="st">"#0076CF"</span>, <span class="st">"#0069D4"</span>, <span class="st">"#005CD9"</span>, <span class="st">"#004EDF"</span>, <span class="st">"#0041E4"</span>, <span class="st">"#0034E9"</span>, <span class="st">"#0027EF"</span>, <span class="st">"#001AF4"</span>, <span class="st">"#000DF9"</span>, <span class="st">"#0000FF"</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">spider</span><span class="op">$</span><span class="va">x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="va">Col</span> <span class="op">&lt;-</span> <span class="va">rbPal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="../reference/ordiplot.gllvm.html">ordiplot</a></span><span class="op">(</span><span class="va">fitnb</span>, symbols <span class="op">=</span> <span class="cn">T</span>, s.colors <span class="op">=</span> <span class="va">Col</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>         biplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="vignette3_files/figure-html/unnamed-chunk-18-1.png" width="576" style="display: block; margin: auto;"></p>
<ul>
<li><p>Here environmental gradients stand out quite clearly, indicating
that, at least, some of the differences in species compositions at sites
can be explained by the differences in environmental
conditions.</p></li>
<li><p>The next step would be to include covariates to the model to
study more precisely the effects of environmental variables:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mrow><mn>0</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>𝐱</mi><mi>i</mi></msub><mi>′</mi><msub><mi>𝛃</mi><mi>j</mi></msub><mo>+</mo><msub><mi>𝐮</mi><mi>i</mi></msub><mi>′</mi><msub><mi>𝛉</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">g(E(y_{ij})) = \beta_{0j} + \boldsymbol{x}_i'\boldsymbol{\beta}_{j} + \boldsymbol{u}_i'\boldsymbol{\theta}_j</annotation></semantics></math></p></li>
</ul>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Niku, J., F.K.C. Hui, S. Taskinen, and D.I. Warton.
2019. Gllvm - Fast Analysis of Multivariate Abundance Data with
Generalized Linear Latent Variable Models in R. 10. Methods in Ecology
and Evolution: 2173–82<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Kasper Kristensen, Anders Nielsen, Casper W. Berg, Hans
Skaug, Bradley M. Bell (2016). TMB: Automatic Differentiation and
Laplace Approximation. Journal of Statistical Software, 70(5), 1-21<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Hui, F. K. C., Warton, D., Ormerod, J., Haapaniemi, V.,
and Taskinen, S. (2017). Variational approximations for generalized
linear latent variable models. Journal of Computational and Graphical
Statistics. Journal of Computational and Graphical Statistics,
26:35-43<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Korhonen, P., Hui, F. K. C., Niku, J., and Taskinen, S.
(2021). Fast, universal estimation of latent variable models using
extended variational approximations, arXiv:2107.02627 .<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Niku, J., Warton, D. I., Hui, F. K. C., and Taskinen, S.
(2017). Generalized linear latent variable models for multivariate count
and biomass data in ecology. Journal of Agricultural, Biological, and
Environmental Statistics, 22:498-522.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>van der Aart, P. J. M., and Smeenk-Enserink, N. (1975)
Correlations between distributions of hunting spiders (Lycosidae,
Ctenidae) and environmental characteristics in a dune area. Netherlands
Journal of Zoology 25, 1-45.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>Dunn, P. K., and Smyth, G. K. (1996). Randomized
quantile residuals. Journal of Computational and Graphical Statistics,
5, 236-244.<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>Gabriel, K. R. (1971). The biplot graphic display of
matrices with application to principal component analysis. Biometrika,
58, 453-467<a href="#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenni Niku, Wesley Brooks, Riki Herliansyah, Francis K.C. Hui, Pekka Korhonen, Sara Taskinen, Bert van der Veen, David I. Warton.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
