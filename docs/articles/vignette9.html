<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Correlation structures for latent variables and row effects ‚Ä¢ gllvm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Correlation structures for latent variables and row effects">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gllvm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette1.html">Analysing multivariate abundance data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette2.html">Analysing high-dimensional microbial community data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette3.html">Introduction to gllvm Part 1: Ordination</a>
    </li>
    <li>
      <a href="../articles/vignette4.html">Introduction to gllvm Part 2: Species correlations</a>
    </li>
    <li>
      <a href="../articles/vignette5.html">How to use the quadratic response model</a>
    </li>
    <li>
      <a href="../articles/vignette6.html">Ordination with predictors</a>
    </li>
    <li>
      <a href="../articles/vignette7.html">Phylogenetic random effects</a>
    </li>
    <li>
      <a href="../articles/vignette8.html">Analysing sparse ecological percent cover data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette9.html">Correlation structures for latent variables and row effects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JenniNiku/gllvm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Correlation structures for latent variables and
row effects</h1>
                        <h4 data-toc-skip class="author">Jenni Niku</h4>
            
            <h4 data-toc-skip class="date">2024-09-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JenniNiku/gllvm/blob/HEAD/vignettes/vignette9.Rmd" class="external-link"><code>vignettes/vignette9.Rmd</code></a></small>
      <div class="hidden name"><code>vignette9.Rmd</code></div>

    </div>

    
    
<!-- This is pre-computed vignette -->
<p>In this example we demonstrate how to set correlation structures for
latent variables and random effects in <strong>gllvm</strong>. The
species abundances are often correlated in time or spatially in
community ecology. In <strong>gllvm</strong>, such correlation
structures can now be set either for latent variables or random row
effects.</p>
<p>Denote the abundance of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>th
species
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>p</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">j\in \{1,\dots, p\}</annotation></semantics></math>)
at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
site
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>n</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">i\in \{1,\dots, n\}</annotation></semantics></math>)
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>.
A set of k environmental variables, or experimental treatments, may also
be recorded at each site and stored in the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùê±</mi><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>x</mi><mrow><mi>i</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{x}_i = (x_{i1}, ..., x_{ik})</annotation></semantics></math>.
A common form for the GLLVM is then defined for the mean abundance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œº</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{ij}</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Œ∑</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>r</mi><mrow><msub><mi>s</mi><mi>a</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>+</mo><msub><mi>Œ≤</mi><mrow><mn>0</mn><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>ùê±</mi><mi>i</mi></msub><mi>‚Ä≤</mi><msub><mi>ùõÉ</mi><mi>j</mi></msub><mo>+</mo><msub><mi>ùêÆ</mi><mrow><msub><mi>s</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mi>‚Ä≤</mi><msub><mi>ùõâ</mi><mi>j</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">g(\mu_{ij}) = \eta_{ij} = r_{s_a(i)} + \beta_{0j} + \boldsymbol{x}_i'\boldsymbol{\beta}_j + \boldsymbol{u}_{s_u(i)}'\boldsymbol{\theta}_j,</annotation></semantics></math></p>
<p>Now we can specify a correlation structure for latent variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÆ</mi><mrow><msub><mi>s</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><mrow><mn>1</mn><mo>,</mo><msub><mi>s</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>u</mi><mrow><mi>d</mi><mo>,</mo><msub><mi>s</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚Ä≤</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{u}_{s_u(i)} = ({u}_{1,s_u(i)}, \dots, {u}_{d,s_u(i)})'</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">d=</annotation></semantics></math>
number of latent variables, defined by <code>num.lv</code> in
<strong>gllvm</strong>) and/or row effects
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>r</mi><mrow><msub><mi>s</mi><mi>r</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><annotation encoding="application/x-tex">r_{s_r(i)}</annotation></semantics></math>.
The subscripts
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">s_u(i)</annotation></semantics></math>
defines the structure of the latent variables. For instance, assume that
we have a hierarchical sampling design with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>s</mi></msub><mo>&lt;</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">n_s&lt;n</annotation></semantics></math>
sites and sites are sampled
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>t</mi></msub><annotation encoding="application/x-tex">n_t</annotation></semantics></math>
times in consecutive years. Thus we could want to include a site level
latent variables such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">s_u(i) = k</annotation></semantics></math>
if sampling unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is from site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>n</mi><mi>s</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">k\in \{1,\dots, n_s\}</annotation></semantics></math>).
Similarly, we can set a structure for the row effects defining subscript
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>r</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">s_r(i)</annotation></semantics></math>,
eg. for time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>r</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">s_r(i) = t</annotation></semantics></math>
if sampling unit
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is from sampling year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>n</mi><mi>t</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">t\in \{1,\dots, n_t\}</annotation></semantics></math>).
Then we can define the correlation structures for latent variables
and/or row effects: denote
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÆ</mi><mrow><mi>q</mi><mi>.</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>u</mi><mrow><mi>q</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>u</mi><mrow><mi>q</mi><msub><mi>n</mi><mi>s</mi></msub></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{u}_{q.} = (u_{q1}, ..., u_{qn_s})</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>q</mi><mi>.</mi></mrow></msub><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>ùüé</mn><mo>,</mo><msub><mi>Œ£</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>q</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>d</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
{u}_{q.} \sim N(\boldsymbol{0}, \Sigma_q), \,  q=1,\dots, d.
</annotation></semantics></math> The covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ£</mi><mi>q</mi></msub><annotation encoding="application/x-tex">\Sigma_q</annotation></semantics></math>
defines the correlation structure and has unit variances on diagonal.
The options are identity (independent), AR(1) correlation, exponentially
decaying correlation structure and Matern correlation. Currently we can
only use the same structure for all latent variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">q=1,\dots,d</annotation></semantics></math>,
but the parameters defining the strength of the correlation is estimated
uniquely for each latent variable.</p>
<p>Similarly, we can define the correlation structure for random row
effect, denote
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùê´</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><msub><mi>r</mi><msub><mi>n</mi><mi>t</mi></msub></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{r} = (r_{1}, ..., r_{n_t})</annotation></semantics></math>,
and set
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>ùüé</mn><mo>,</mo><msub><mi>Œ£</mi><mi>r</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
{r} \sim N(\boldsymbol{0}, \Sigma_r),
</annotation></semantics></math> where the covariance matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ£</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\Sigma_r</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>t</mi></msub><mo>√ó</mo><msub><mi>n</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">n_t \times n_t</annotation></semantics></math>
matrix and defines the correlation structure for random row effect. For
row effects we have the same options as we have for latent variables.
The structure for the row effects can be different from the structure of
the latent variables and this is illustrated in the case study
below.</p>
<p>As an example, we use time series of sessile algal and invertebrate
species from permanent transects (Arkema et al.¬†2009, <span class="citation">Reed and Miller (2023)</span>). Data consists of
percent cover of 132 species from 11 sites which each have 2-8
transects, yearly recorded from 2000 to 2021. It also includes
measurements of the environment; the number of stripes of giant kelp and
percent rock. In total, data has 836 sampling units.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jenniniku.github.io/gllvm/" class="external-link">gllvm</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"kelpforest"</span><span class="op">)</span></span>
<span><span class="va">Yabund</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">Xenv</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">SPinfo</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">SPinfo</span></span></code></pre></div>
<p>Species percent cover matrix is in <code>Yabund</code>, for the
analyses we consider only sessile invertebrates and include species
observed at least 10 times. The rarest species are modeled as a sum.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Yabund</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##    AB AL AMZO   ANSP AR ARUD     AS ATM     AU     BA BAEL BCAL     BF BLD     BN</span></span>
<span><span class="co">## 1   0  0    0 0.0125  0    0 0.1125   0 0.0125 0.0000    0    0 0.0000   0 0.0125</span></span>
<span><span class="co">## 2   0  0    0 0.0000  0    0 0.0000   0 0.0000 0.0000    0    0 0.0125   0 0.0000</span></span>
<span><span class="co">## 3   0  0    0 0.0000  0    0 0.0750   0 0.0000 0.0000    0    0 0.0000   0 0.0000</span></span>
<span><span class="co">## 4   0  0    0 0.0000  0    0 0.0125   0 0.0000 0.0000    0    0 0.0125   0 0.0000</span></span>
<span><span class="co">## 5   0  0    0 0.0000  0    0 0.0000   0 0.0000 0.0000    0    0 0.0000   0 0.0000</span></span>
<span><span class="co">## 6   0  0    0 0.0000  0    0 0.0000   0 0.0000 0.0000    0    0 0.0000   0 0.0000</span></span>
<span><span class="co">## 7   0  0    0 0.0000  0    0 0.0000   0 0.0000 0.0000    0    0 0.0000   0 0.0000</span></span>
<span><span class="co">## 8   0  0    0 0.0000  0    0 0.0000   0 0.0000 0.0000    0    0 0.0000   0 0.0000</span></span>
<span><span class="co">## 9   0  0    0 0.0000  0    0 0.0500   0 0.0000 0.0125    0    0 0.0000   0 0.0000</span></span>
<span><span class="co">## 10  0  0    0 0.0000  0    0 0.0250   0 0.0000 0.0000    0    0 0.0125   0 0.0000</span></span>
<span><span class="co">##    BO BOW BPSE     BR    BRA</span></span>
<span><span class="co">## 1   0   0    0 0.0250 0.0375</span></span>
<span><span class="co">## 2   0   0    0 0.0250 0.0125</span></span>
<span><span class="co">## 3   0   0    0 0.0375 0.0000</span></span>
<span><span class="co">## 4   0   0    0 0.0000 0.0000</span></span>
<span><span class="co">## 5   0   0    0 0.0125 0.0000</span></span>
<span><span class="co">## 6   0   0    0 0.0000 0.0125</span></span>
<span><span class="co">## 7   0   0    0 0.0000 0.0000</span></span>
<span><span class="co">## 8   0   0    0 0.0000 0.0000</span></span>
<span><span class="co">## 9   0   0    0 0.1000 0.0000</span></span>
<span><span class="co">## 10  0   0    0 0.1000 0.0875</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Yinvert</span> <span class="op">&lt;-</span> <span class="va">Yabund</span><span class="op">[</span><span class="va">SPinfo</span><span class="op">$</span><span class="va">GROUP</span> <span class="op">==</span> <span class="st">"INVERT"</span><span class="op">]</span></span>
<span><span class="va">Yinvert10</span> <span class="op">=</span> <span class="va">Yinvert</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">Yinvert</span><span class="op">&gt;</span><span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">9</span><span class="op">]</span></span>
<span><span class="co"># Sum species that were observed less than 9 times, </span></span>
<span><span class="va">Yinvert10</span><span class="op">$</span><span class="va">Sum_inv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Yinvert</span><span class="op">[</span>,<span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">Yinvert</span><span class="op">&gt;</span><span class="fl">0</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">9</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>There is information about the species:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SPinfo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SP_CODE  GROUP            COMMON_NAME     SCIENTIFIC_NAME TAXON_KINGDOM</span></span>
<span><span class="co">## 1      AB INVERT Coarse Sea Fir Hydroid    Abietinaria spp.      Animalia</span></span>
<span><span class="co">## 2      AL INVERT  Aggregating cup Coral    Astrangia haimei      Animalia</span></span>
<span><span class="co">## 3    AMZO  ALGAE                   &lt;NA&gt; Amphiroa beauvoisii       Plantae</span></span>
<span><span class="co">## 4    ANSP INVERT    Aggregating anemone    Anthopleura spp.      Animalia</span></span>
<span><span class="co">## 5      AR INVERT          Sand Tunicate  Eudistoma psammion      Animalia</span></span>
<span><span class="co">## 6    ARUD INVERT              Octocoral   Discophyton rudyi      Animalia</span></span>
<span><span class="co">##   TAXON_PHYLUM     TAXON_CLASS     TAXON_ORDER    TAXON_FAMILY TAXON_GENUS</span></span>
<span><span class="co">## 1     Cnidaria        Hydrozoa    Leptothecata   Sertulariidae Abietinaria</span></span>
<span><span class="co">## 2     Cnidaria        Anthozoa    Scleractinia    Rhizangiidae   Astrangia</span></span>
<span><span class="co">## 3   Rhodophyta Florideophyceae    Corallinales Lithophyllaceae    Amphiroa</span></span>
<span><span class="co">## 4     Cnidaria        Anthozoa      Actiniaria      Actiniidae Anthopleura</span></span>
<span><span class="co">## 5     Chordata      Ascidiacea Aplousobranchia   Polycitoridae   Eudistoma</span></span>
<span><span class="co">## 6     Cnidaria        Anthozoa      Alcyonacea     Alcyoniidae Discophyton</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SPinfo10</span> <span class="op">=</span> <span class="va">SPinfo</span><span class="op">[</span><span class="va">SPinfo</span><span class="op">$</span><span class="va">SP_CODE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Yinvert10</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">SPinfo10</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">SPinfo10</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sum_inv"</span>,<span class="st">"INVERT"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">SPinfo10</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And finally, information about the study design (site name, year,
transect index) and environmental coefficients (average number of kelp
fronds, percent rock). The distribution of kelp fronds is very skewed to
the right so a log of the number of kelp fronds is used as a covariate
instead. In addition, covariates are scaled.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SITE YEAR TRANSECT KELP_FRONDS PERCENT_ROCKY</span></span>
<span><span class="co">## 1 ABUR 2001        1     13.8750          35.0</span></span>
<span><span class="co">## 2 ABUR 2001        2      0.0000          37.5</span></span>
<span><span class="co">## 3 ABUR 2002        1      8.5125          10.0</span></span>
<span><span class="co">## 4 ABUR 2002        2      0.3875           2.5</span></span>
<span><span class="co">## 5 ABUR 2003        1      0.6000           0.0</span></span>
<span><span class="co">## 6 ABUR 2003        2      0.0000           0.0</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">KELP_FRONDS</span>, main <span class="op">=</span> <span class="st">"KELP FRONDS"</span><span class="op">)</span></span>
<span><span class="va">Xenv</span><span class="op">$</span><span class="va">logKELP_FRONDS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">KELP_FRONDS</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Xenv</span><span class="op">$</span><span class="va">logKELP_FRONDSsc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">logKELP_FRONDS</span><span class="op">)</span></span>
<span><span class="va">Xenv</span><span class="op">$</span><span class="va">PERCENT_ROCKYsc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">PERCENT_ROCKY</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">logKELP_FRONDSsc</span>, main <span class="op">=</span> <span class="st">"log of KELP FRONDS"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="Xcovar-1.png" alt="plot of chunk Xcovar"><p class="caption">
plot of chunk Xcovar
</p>
</div>
<p>For modeling percent cover data, has three options, beta for values
(0,1), ordered beta for [0,1] and beta hurdle model for [0,1). Here we
use beta-hurdle response model.</p>
<div class="section level2">
<h2 id="structured-and-correlated-random-row-effects">Structured and correlated random row effects<a class="anchor" aria-label="anchor" href="#structured-and-correlated-random-row-effects"></a>
</h2>
<p>The structure for row effects can be defined using argument
<code>row.eff</code> and defining the study design using argument
<code>studyDesign</code>. The structure is defined by common formula
interface; eg. <code>row.eff = ~(1|site)</code> and <code>site</code>
factor in a <code>data.frame</code> given in argument
<code>studyDesign</code> defines site level random effects. There are
four correlation structures available in , AR(1) <code>corAR1</code>,
compound symmetry <code>corCS</code>, exponentially decaying
<code>corExp</code> and Matern correlation <code>corMatern</code>. If
one would like to set eg. spatial correlation structure for the site
level random effects, it could be defined for instance by
<code>row.eff = ~corExp(1|site)</code> and spatial coordinates given to
<code>dist</code> as a matrix. Multiple row effect structures are
allowed.</p>
<p>In the next example, we attempt to model species abundances
correlation in time using AR(1) correlated random effect for sampling
year as well as site level row effects. Latent variables are left out
from this model for now.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the study design, now we need year and site</span></span>
<span><span class="va">studyDesign</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">YEAR</span><span class="op">)</span>, site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">SITE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Set common shape parameter of beta distribution for different species (optional)</span></span>
<span><span class="va">shapeForm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yinvert10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model with AR(1) correlated random effect for sampling year</span></span>
<span><span class="va">ftRowAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Yinvert10</span>, <span class="va">Xenv</span>, family <span class="op">=</span> <span class="st">"betaH"</span>, </span>
<span>                 formula <span class="op">=</span> <span class="op">~</span> <span class="va">logKELP_FRONDSsc</span> <span class="op">+</span> <span class="va">PERCENT_ROCKYsc</span>, </span>
<span>                 studyDesign <span class="op">=</span> <span class="va">studyDesign</span>, </span>
<span>                 row.eff <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">site</span><span class="op">)</span> <span class="op">+</span> <span class="fu">corAR1</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">year</span><span class="op">)</span>,  </span>
<span>                 num.lv <span class="op">=</span> <span class="fl">0</span>, disp.formula <span class="op">=</span> <span class="va">shapeForm</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ftRowAR</span></span></code></pre></div>
<pre><code><span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = Yinvert10, X = Xenv, formula = ~logKELP_FRONDSsc + </span></span>
<span><span class="co">##     PERCENT_ROCKYsc, family = "betaH", num.lv = 0, studyDesign = studyDesign, </span></span>
<span><span class="co">##     row.eff = ~(1 | site) + corAR1(1 | year), disp.formula = shapeForm)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "betaH"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -1448.781 </span></span>
<span><span class="co">## Residual degrees of freedom:  48907 </span></span>
<span><span class="co">## AIC:  3731.561 </span></span>
<span><span class="co">## AICc:  3738.689 </span></span>
<span><span class="co">## BIC:  7403.732</span></span></code></pre>
<p>If we look at the estimates, sd of the random effect for site is
0.106 and for year is 0.037 and AR(1) correlation between two
consecutive years is 0.57. See below the parameter values and the row
effects for years</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sds for random row effects and Correlation for consecutive years</span></span>
<span><span class="va">ftRowAR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">sigma</span></span></code></pre></div>
<pre><code><span><span class="co">##       site       year    yearrho </span></span>
<span><span class="co">## 0.10601458 0.03676497 0.57861515</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot random effects and 95% predicted envelope</span></span>
<span><span class="va">rowSite</span> <span class="op">=</span> <span class="va">ftRowAR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">row.params</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ftRowAR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">row.params</span><span class="op">)</span> <span class="op">==</span> <span class="st">"site"</span><span class="op">]</span></span>
<span><span class="va">years</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">studyDesign</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rowYear</span> <span class="op">=</span> <span class="va">ftRowAR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">row.params</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ftRowAR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">row.params</span><span class="op">)</span> <span class="op">==</span> <span class="st">"year"</span><span class="op">]</span></span>
<span><span class="co"># Calculate prediction errors for row effects:</span></span>
<span><span class="va">predLVR</span> <span class="op">=</span> <span class="fu"><a href="../reference/getPredictErr.gllvm.html">getPredictErr</a></span><span class="op">(</span><span class="va">ftRowAR</span><span class="op">)</span></span>
<span><span class="co"># prediction errors for site effects</span></span>
<span><span class="va">seSite</span> <span class="op">=</span> <span class="va">predLVR</span><span class="op">$</span><span class="va">row.effects</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># prediction errors for year effects</span></span>
<span><span class="va">seYear</span> <span class="op">=</span> <span class="va">predLVR</span><span class="op">$</span><span class="va">row.effects</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co"># Plot:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">rowSite</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">rowSite</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">seSite</span><span class="op">)</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Random effect: site"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">rowSite</span> <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">seSite</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">rowSite</span> <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">seSite</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">rowYear</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">rowYear</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">seYear</span><span class="op">)</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Random effect: year"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">rowYear</span> <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">seYear</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">rowYear</span> <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">seYear</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="plotrow-1.png" alt="plot of chunk plotrow"><p class="caption">
plot of chunk plotrow
</p>
</div>
<p>The random effect for year represents the average trend of the all
species abundances over the years which is not explained by the
covariates.</p>
<p>To evaluate how much of the variation random effects and covariates
are able to explain, calculate variance partitioning for the model. The
random effect for year explains on average only 1.6% and the random
effect for site 13.9% of the variation when modeling the probability of
the presence, while conditional on the presence of the species, random
year explains on average 5.9% and random site 52.5% of the variation of
the coverage.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VP1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varPartitioning.gllvm.html">varPartitioning</a></span><span class="op">(</span><span class="va">ftRowAR</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/varPartitioning.gllvm.html">plotVP</a></span><span class="op">(</span><span class="va">VP1</span>, args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Roma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="VP1-1.png" alt="plot of chunk VP1"><p class="caption">
plot of chunk VP1
</p>
</div>
</div>
<div class="section level2">
<h2 id="structured-and-correlated-latent-variables">Structured and correlated latent variables<a class="anchor" aria-label="anchor" href="#structured-and-correlated-latent-variables"></a>
</h2>
<div class="section level3">
<h3 id="structured-latent-variables">Structured latent variables<a class="anchor" aria-label="anchor" href="#structured-latent-variables"></a>
</h3>
<p>In the previous example, we did not include latent variables in the
model, but let‚Äôs focus on them now. Similarly to row effects we can now
set a structure for the latent variables as well using argument
<code>lvCor</code>. For instance, we could like to account the variation
in transects and sites and possible missing environmental covariates
that affect the species abundances. So let‚Äôs include in the model also
transect level latent variables, leave random effect for site out:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the study design, now we need year and site x transect</span></span>
<span><span class="va">Xenv</span><span class="op">$</span><span class="va">STRANSECT</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">SITE</span>,<span class="va">Xenv</span><span class="op">$</span><span class="va">TRANSECT</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">studyDesign</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">YEAR</span><span class="op">)</span>, stransect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">STRANSECT</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Fit model with AR(1) correlated random effect for sampling year</span></span>
<span><span class="co"># and two transect level latent variable (two LVs model was better than 1 LV)</span></span>
<span><span class="co"># Different starting values can be tested but zero starting values worked best in this case:</span></span>
<span><span class="co"># (This can take a few minutes ~2-5)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ftRowAR_lv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Yinvert10</span>, <span class="va">Xenv</span>, family <span class="op">=</span> <span class="st">"betaH"</span>,</span>
<span>                     formula <span class="op">=</span> <span class="op">~</span> <span class="va">logKELP_FRONDSsc</span> <span class="op">+</span> <span class="va">PERCENT_ROCKYsc</span>,</span>
<span>                     studyDesign <span class="op">=</span> <span class="va">studyDesign</span>, row.eff <span class="op">=</span> <span class="op">~</span> <span class="fu">corAR1</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">year</span><span class="op">)</span>,  </span>
<span>                     num.lv <span class="op">=</span> <span class="fl">2</span>, lvCor <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">stransect</span><span class="op">)</span>, </span>
<span>                     disp.formula <span class="op">=</span> <span class="va">shapeForm</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ftRowAR_lv2</span></span></code></pre></div>
<pre><code><span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = Yinvert10, X = Xenv, formula = ~logKELP_FRONDSsc + </span></span>
<span><span class="co">##     PERCENT_ROCKYsc, family = "betaH", num.lv = 2, lvCor = ~(1 | </span></span>
<span><span class="co">##     stransect), studyDesign = studyDesign, row.eff = ~corAR1(1 | </span></span>
<span><span class="co">##     year), disp.formula = shapeForm)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "betaH"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  793.3203 </span></span>
<span><span class="co">## Residual degrees of freedom:  48673 </span></span>
<span><span class="co">## AIC:  -284.6406 </span></span>
<span><span class="co">## AICc:  -267.1993 </span></span>
<span><span class="co">## BIC:  5448.174</span></span></code></pre>
<p>Below we plot the ordination, which is now at transect level, not
sample level.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Color code for sites</span></span>
<span><span class="va">colSite</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">studyDesign</span><span class="op">$</span><span class="va">stransect</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Xenv</span><span class="op">$</span><span class="va">SITE</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">studyDesign</span><span class="op">$</span><span class="va">stransect</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Ordination of sites+transect/Latent variables with 95% prediction regions</span></span>
<span><span class="fu"><a href="../reference/ordiplot.gllvm.html">ordiplot</a></span><span class="op">(</span><span class="va">ftRowAR_lv2</span>, predict.region <span class="op">=</span> <span class="st">"sites"</span>, s.colors <span class="op">=</span> <span class="va">colSite</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Random effect for years:</span></span>
<span><span class="va">years</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">studyDesign</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rowYear2</span> <span class="op">=</span> <span class="va">ftRowAR_lv2</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">row.params</span></span>
<span><span class="va">years</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">studyDesign</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">predLVR</span> <span class="op">=</span> <span class="fu"><a href="../reference/getPredictErr.gllvm.html">getPredictErr</a></span><span class="op">(</span><span class="va">ftRowAR_lv2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">rowYear2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">rowYear2</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.96</span>,<span class="fl">1.96</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">predLVR</span><span class="op">$</span><span class="va">row.effects</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Random effect year"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">rowYear2</span> <span class="op">-</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">predLVR</span><span class="op">$</span><span class="va">row.effects</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">rowYear2</span> <span class="op">+</span> <span class="fl">1.96</span><span class="op">*</span><span class="va">predLVR</span><span class="op">$</span><span class="va">row.effects</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, col<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="ordiplot1-1.png" alt="plot of chunk ordiplot1"><p class="caption">
plot of chunk ordiplot1
</p>
</div>
<p>The variance partitioning for the model shows that random effect for
year explains on average only 0.6% of the variation when modeling the
probability of the presence, while conditional on the presence of the
species, random year explains on average 20.5% of the variation of the
coverage. On the other hand, transect level latent variables can explain
a total of 60% of the variation in presence-absence model, while for
coverage model the proportion is smaller, around 40%.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">VP2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varPartitioning.gllvm.html">varPartitioning</a></span><span class="op">(</span><span class="va">ftRowAR_lv2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/varPartitioning.gllvm.html">plotVP</a></span><span class="op">(</span><span class="va">VP2</span>, args.legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cex<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"Roma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="VP2-1.png" alt="plot of chunk VP2"><p class="caption">
plot of chunk VP2
</p>
</div>
</div>
<div class="section level3">
<h3 id="correlated-latent-variables">Correlated latent variables<a class="anchor" aria-label="anchor" href="#correlated-latent-variables"></a>
</h3>
<p>It is also possible to specify a correlation structure for latent
variables. An optimal choice would be to continue the analysis by
setting spatial correlation structure for the sites or the transects,
but the data do not have information about the coordinates. Instead, we
illustrate this functionality below by setting AR(1) correlated latent
variable for years. The variability between sites is now taken into
account with random row effect.</p>
<p>Regarding the model estimation method, by default package uses
variational approximation (VA) method. VA-method approximates the
posterior distribution of the random effects and latent variables with
so called a variational covariance matrix. The structure of the
variational covariance can affect the accuracy of the method. For
example, an unstuctured variational covariance matrix (default) may lead
to more accurate results, but as a downside, it can be slow. If the
number of correlated levels, eg. sites or time points, is small, it does
not matter that much which structure is chosen, but for large number of
correlated levels the difference in computation time may be significant.
For correlated LVs there are few different options, as a alternatives to
the default choice we suggest either <code>Lambda.struc = "bdNN"</code>
or <code>Lambda.struc = "UNN"</code> methods (these are the same if
number of correlated LVs is 1). The complexity of those structures can
be modified with argument <code>NN</code> which can be between 2 and the
number of levels of the variable defining correlation structure -1 (eg.
number of spatially correlated sites -1 or number of correlated time
points -1). For this example, we set <code>Lambda.struc = "bdNN"</code>
and <code>NN=5</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check first the number of correlated levels:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">studyDesign</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="co"># Number of levels = number of years = 21, so NN can be at most 21-1 = 20</span></span>
<span><span class="co"># And then bdNN structure would be same as unstructured variational covariance matrix</span></span>
<span><span class="co"># In the example below, we set NN = 5. For this example, </span></span>
<span><span class="co"># larger number does not improve the model fit anymore.</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit model with AR(1) correlated latent variables for sampling year</span></span>
<span><span class="co"># and transect level random row effect</span></span>
<span><span class="co"># (This can take a few minutes)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">ftRow_lv1AR</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Yinvert10</span>, <span class="va">Xenv</span>, family <span class="op">=</span> <span class="st">"betaH"</span>,</span>
<span>                     formula <span class="op">=</span> <span class="op">~</span> <span class="va">logKELP_FRONDSsc</span> <span class="op">+</span> <span class="va">PERCENT_ROCKYsc</span>,</span>
<span>                     studyDesign <span class="op">=</span> <span class="va">studyDesign</span>, row.eff <span class="op">=</span> <span class="op">~</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">stransect</span><span class="op">)</span>,  </span>
<span>                     num.lv <span class="op">=</span> <span class="fl">1</span>, lvCor <span class="op">=</span> <span class="op">~</span> <span class="fu">corAR1</span><span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">year</span><span class="op">)</span>, </span>
<span>                     Lambda.struc <span class="op">=</span> <span class="st">"bdNN"</span>, NN<span class="op">=</span><span class="fl">5</span>, diag.iter <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                     disp.formula <span class="op">=</span> <span class="va">shapeForm</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ftRow_lv1AR</span></span></code></pre></div>
<pre><code><span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = Yinvert10, X = Xenv, formula = ~logKELP_FRONDSsc + </span></span>
<span><span class="co">##     PERCENT_ROCKYsc, family = "betaH", num.lv = 1, lvCor = ~corAR1(1 | </span></span>
<span><span class="co">##     year), studyDesign = studyDesign, row.eff = ~(1 | stransect), </span></span>
<span><span class="co">##     disp.formula = shapeForm, Lambda.struc = "bdNN", NN = 5, </span></span>
<span><span class="co">##     diag.iter = 0)</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "betaH"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "VA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  -922.7426 </span></span>
<span><span class="co">## Residual degrees of freedom:  48790 </span></span>
<span><span class="co">## AIC:  2913.485 </span></span>
<span><span class="co">## AICc:  2925.196 </span></span>
<span><span class="co">## BIC:  7615.978</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Correlation for consecutive years (LV)</span></span>
<span><span class="va">ftRow_lv1AR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">rho.lv</span></span></code></pre></div>
<pre><code><span><span class="co">##   rho.lv1 </span></span>
<span><span class="co">## 0.9046357</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sd of random row effects for transects</span></span>
<span><span class="va">ftRow_lv1AR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">sigma</span></span></code></pre></div>
<pre><code><span><span class="co">## stransect </span></span>
<span><span class="co">## 0.1433812</span></span></code></pre>
<p>The correlation for consequtive years is strong 0.90. Below we view
the species specific yearly trends in the products of latent variables
and loadings.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># When variation between sites was taken into account, there is no clear common trend</span></span>
<span><span class="va">LVloadings</span> <span class="op">=</span> <span class="va">ftRow_lv1AR</span><span class="op">$</span><span class="va">lvs</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ftRow_lv1AR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">theta</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ftRow_lv1AR</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">sigma.lv</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">years</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">studyDesign</span><span class="op">$</span><span class="va">year</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">LVloadings</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yinvert10</span><span class="op">)</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"LV*Loadings"</span>, main <span class="op">=</span> <span class="st">"Beta"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">years</span>, <span class="va">LVloadings</span><span class="op">[</span>,<span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yinvert10</span><span class="op">)</span><span class="op">)</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"LV*Loadings"</span>, main <span class="op">=</span> <span class="st">"Hurdle"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="lvAR-1.png" alt="plot of chunk lvAR"><p class="caption">
plot of chunk lvAR
</p>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-SBCLTER2023" class="csl-entry">
Reed, D., and R. Miller. 2023. <span>‚ÄúSBC LTER; Reef; Kelp Forest
Community Dynamics, Cover of Sessile Organisms, Uniform Point Contact.
Environmental Data Initiative.‚Äù</span> Environmental Data Initiative.
https://doi.org/<a href="https://doi.org/10.6073/pasta/0af1a5b0d9dde5b4e5915c0012ccf99c" class="external-link">https://doi.org/10.6073/pasta/0af1a5b0d9dde5b4e5915c0012ccf99c</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenni Niku, Wesley Brooks, Riki Herliansyah, Francis K.C. Hui, Pekka Korhonen, Sara Taskinen, Bert van der Veen, David I. Warton.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
