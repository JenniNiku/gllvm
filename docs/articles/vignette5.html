<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How to use the quadratic response model • gllvm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How to use the quadratic response model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gllvm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette1.html">Analysing multivariate abundance data using gllvm</a></li>
    <li><a class="dropdown-item" href="../articles/vignette2.html">Analysing high-dimensional microbial community data using gllvm</a></li>
    <li><a class="dropdown-item" href="../articles/vignette3.html">Introduction to gllvm Part 1: Ordination</a></li>
    <li><a class="dropdown-item" href="../articles/vignette4.html">Introduction to gllvm Part 2: Species correlations</a></li>
    <li><a class="dropdown-item" href="../articles/vignette5.html">How to use the quadratic response model</a></li>
    <li><a class="dropdown-item" href="../articles/vignette6.html">Ordination with predictors</a></li>
    <li><a class="dropdown-item" href="../articles/vignette7.html">Phylogenetic random effects</a></li>
    <li><a class="dropdown-item" href="../articles/vignette8.html">Analysing sparse ecological percent cover data using gllvm</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JenniNiku/gllvm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>How to use the quadratic response model</h1>
                        <h4 data-toc-skip class="author">Bert van der
Veen</h4>
            
            <h4 data-toc-skip class="date">2024-09-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JenniNiku/gllvm/blob/HEAD/vignettes/vignette5.Rmd" class="external-link"><code>vignettes/vignette5.Rmd</code></a></small>
      <div class="d-none name"><code>vignette5.Rmd</code></div>
    </div>

    
    
<p>In this example we demonstrate how to implement the quadratic
response model in . Quadratic curves are frequently occurring in
community ecology, specifically to describe the response of species to
the environment. When one has measured predictor variables, a quadratic
function can straightforwardly be included in a regression in R using
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>l</mi><mi>y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>⋅</mo><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">poly(\cdot,2)</annotation></semantics></math>
function. However, in a GLLVM, latent variables are included that can
represent unmeasured predictors. As such, we might want to test if
species respond to those unknown predictors too. This is similar to the
theory behind other ordination methods, such as Correspondence Analysis
and its constrained variant (CCA).</p>
<p>We will use the hunting spider dataset as an example, which includes
12 species at 100 sites. It also includes measurements of the
environment at 28 sites, though we will not use those here.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jenniniku.github.io/gllvm/" class="external-link">gllvm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"spider"</span>, package <span class="op">=</span> <span class="st">"mvabund"</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">spider</span><span class="op">$</span><span class="va">abund</span></span></code></pre></div>
<p>The unique thing about the quadratic response model, is that
specifying a quadratic term for each species separately, coincides with
the assumption that species have their own ecological tolerances. A more
simple more, would be to assume that species have the same tolerance, in
essence that all species are a generalist or specialist to the same
degree. This can be done using a linear response model, with random
row-effects:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ftEqTol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Y</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, row.eff <span class="op">=</span> <span class="st">"random"</span>, num.lv <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>Next, we can fit a model where we assume species tolerances are the
same for all species, but unique per latent variable, which we will
refer to as species common tolerances. We do this using the
<code>quadratic</code> flag in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">gllvm</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{gllvm}(.)</annotation></semantics></math>
function, which has the options <code>FALSE</code>, <code>LV</code>
(common tolerances), and <code>TRUE</code> (unique tolerances for all
species).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ftComTol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Y</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, num.lv <span class="op">=</span> <span class="fl">2</span>, quadratic <span class="op">=</span> <span class="st">"LV"</span><span class="op">)</span></span></code></pre></div>
<p>And lastly, we can fit the full quadratic model.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ftUneqTol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Y</span>, family <span class="op">=</span> <span class="st">"poisson"</span>, num.lv <span class="op">=</span> <span class="fl">2</span>, quadratic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>GLLVMs are sensitive to the starting values, and with a quadratic
response model even more so. As such, the unequal tolerances model by
defaults fits a common tolerances model first, to use as starting
values. This option is control through the <code>start.struc</code>
argument in <code>start.control</code>.</p>
<p>Now, we can use information criteria to determine which of the models
fits the hunting spider data best.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/AICc.html">AICc</a></span><span class="op">(</span><span class="va">ftEqTol</span>,<span class="va">ftComTol</span>,<span class="va">ftUneqTol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1671.791 1673.141 1455.211</span></span></code></pre>
<p>The unequal tolerances model fits best, as measured by AICc. Species
optima and tolerances, and their approximate standard errors, can be
extracted:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Species optima for LVs</span></span>
<span><span class="fu"><a href="../reference/ecoCoefs.html">optima</a></span><span class="op">(</span><span class="va">ftUneqTol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    LV1         LV2</span></span>
<span><span class="co">## Alopacce  9.825144e-01  0.00000000</span></span>
<span><span class="co">## Alopcune -1.375874e+00  0.60240720</span></span>
<span><span class="co">## Alopfabr  7.141189e-01 -1.38573153</span></span>
<span><span class="co">## Arctlute -2.638110e-02  1.21143240</span></span>
<span><span class="co">## Arctperi  1.224321e-01 -1.77525147</span></span>
<span><span class="co">## Auloalbi -5.793132e+00  0.88524850</span></span>
<span><span class="co">## Pardlugu -3.743738e+09  0.04771125</span></span>
<span><span class="co">## Pardmont  1.658707e+00  1.74690559</span></span>
<span><span class="co">## Pardnigr -5.638948e-01  0.72451937</span></span>
<span><span class="co">## Pardpull -6.342601e-01  0.93395420</span></span>
<span><span class="co">## Trocterr -5.999277e-01  0.81762632</span></span>
<span><span class="co">## Zoraspin -4.890806e-01  1.28396883</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Species tolerances</span></span>
<span><span class="fu"><a href="../reference/ecoCoefs.html">tolerances</a></span><span class="op">(</span><span class="va">ftUneqTol</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                   LV1          LV2</span></span>
<span><span class="co">## Alopacce 4.933901e-01 2.099662e+04</span></span>
<span><span class="co">## Alopcune 2.216327e+00 4.085843e-01</span></span>
<span><span class="co">## Alopfabr 4.839301e-01 1.048048e+00</span></span>
<span><span class="co">## Arctlute 2.978479e-01 4.331754e-01</span></span>
<span><span class="co">## Arctperi 5.596676e-01 4.253645e-01</span></span>
<span><span class="co">## Auloalbi 2.118144e+00 3.939626e-01</span></span>
<span><span class="co">## Pardlugu 4.447914e+04 6.928517e-01</span></span>
<span><span class="co">## Pardmont 1.010298e+00 1.185296e+00</span></span>
<span><span class="co">## Pardnigr 5.986937e-01 3.901281e-01</span></span>
<span><span class="co">## Pardpull 8.583623e-01 3.749587e-01</span></span>
<span><span class="co">## Trocterr 9.731248e-01 7.210429e-01</span></span>
<span><span class="co">## Zoraspin 5.994577e-01 8.675581e-01</span></span></code></pre>
<p>The standard deviation of the latent variables can be printed using
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">summary</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{summary}(.)</annotation></semantics></math>
function. Since latent variable models are scale invariant, this scale
parameter is relative to the identifiability constraint (diagonal of the
species scores matrix). It can be understood as a measure of gradient
length, though for a measure that might be more comparable to DCA
(i.e. on average unit variance species curves), see the reference
below.</p>
<p>The residual variation explained can be used to calculate residual
correlations, or to partition variation, similar as in the vanilla
GLLVM:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Residual variance per latent variable</span></span>
<span><span class="co">#for the linear term</span></span>
<span><span class="fu"><a href="../reference/getResidualCov.gllvm.html">getResidualCov</a></span><span class="op">(</span><span class="va">ftUneqTol</span><span class="op">)</span><span class="op">$</span><span class="va">var.q</span></span></code></pre></div>
<pre><code><span><span class="co">##       LV1       LV2 </span></span>
<span><span class="co">##  39.26665 258.82103</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#for the quadratic term</span></span>
<span><span class="fu"><a href="../reference/getResidualCov.gllvm.html">getResidualCov</a></span><span class="op">(</span><span class="va">ftUneqTol</span><span class="op">)</span><span class="op">$</span><span class="va">var.q2</span></span></code></pre></div>
<pre><code><span><span class="co">##     LV1^2     LV2^2 </span></span>
<span><span class="co">##  95.95021 120.62052</span></span></code></pre>
<p>Finally, we can use the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">ordiplot</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{ordiplot}(.)</annotation></semantics></math>
function to visualize the species optima. However, since species optima
can be quite large if they are unobserved, or if too little information
is present in the data, creating a nice figure can be challenging. One
attempt to improve readability of the species optima in a figure is to
point an arrow in their general direction, if species optima are
“unobserved”: outside of the range of the predicted site scores.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ordiplot.gllvm.html">ordiplot</a></span><span class="op">(</span><span class="va">ftUneqTol</span>, biplot<span class="op">=</span><span class="cn">TRUE</span>, spp.arrows <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette5_files/figure-html/quad_plot-1.png" width="480" style="display: block; margin: auto;"></p>
<p>The standard deviation of the latent variables, presented in the
summary information of the model, can serve as a measure of gradient
length. This measure is different to that presented in <span class="citation">van der Veen et al. (2021)</span>, and not directly
comparable to e.g. the output of axis length by Detrended Correspondence
Analysis (DCA).</p>
<p>Alternatively, we can also calculate it following the definition of
van der Veen et al (2021), with a minor correction. This also allows us
to calculate the rate of turnover along the gradient. It is most
straightforward to do this with the “common tolerances” model, although
we can do it with the unequal tolerances model. But, then we need to
decide how to standardise the species curves (e.g., so that the mean or
median tolerance is one).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract tolerances</span></span>
<span><span class="va">tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ecoCoefs.html">tolerances</a></span><span class="op">(</span><span class="va">ftComTol</span>, sd.errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">gradLength</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">/</span><span class="va">tol</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">turn</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">.999</span>, sd <span class="op">=</span> <span class="va">tol</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gradient length:"</span>, <span class="va">gradLength</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gradient length: 7.583041 1.792611</span></span></code></pre>
<p>This measure of gradient length tells us that the second LVs
represents a short gradient. That is also visible from the figure below,
as most species responses are estimated to be (near) linear. To visually
inspect the rate of turnover we will plot the species curves.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Turnover rate:"</span>, <span class="va">turn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Turnover rate: 3.260151 13.79098</span></span></code></pre>
<p>The turnover rate is naturally quicker on the longer gradient, so
shorter for the second latent variable than the first. This means that
we expect the community to change faster along the first latent
variable; about every 3.26 units of the latent variable we encounter a
completely different community, while on the second latent variable this
takes much more, about 14 units. That corresponds with having a short
gradient; if species response are nearly linear they virtually occur
everywhere along the gradient, in contrast to when responses are
unimodal.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">LVs</span> <span class="op">=</span> <span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">)</span></span>
<span><span class="va">newLV</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>LV1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">LVs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">LVs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>, LV2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.gllvm.html">predict</a></span><span class="op">(</span><span class="va">ftComTol</span>, type <span class="op">=</span> <span class="st">"response"</span>, newLV <span class="op">=</span> <span class="va">newLV</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">preds</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, ylab  <span class="op">=</span> <span class="st">"Predicted response"</span>, xlab <span class="op">=</span> <span class="st">"LV1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span>x0<span class="op">=</span><span class="fu"><a href="../reference/ecoCoefs.html">optima</a></span><span class="op">(</span><span class="va">ftComTol</span>, sd.errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="fu"><a href="../reference/ecoCoefs.html">optima</a></span><span class="op">(</span><span class="va">ftComTol</span>, sd.errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, y1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">preds</span>,<span class="fl">2</span>,<span class="va">max</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">newLV</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="va">preds</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">newLV</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="va">j</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LVs</span> <span class="op">=</span> <span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">)</span></span>
<span><span class="va">newLV</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>LV1 <span class="op">=</span> <span class="fl">0</span>, LV2 <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">LVs</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">LVs</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.gllvm.html">predict</a></span><span class="op">(</span><span class="va">ftComTol</span>, type <span class="op">=</span> <span class="st">"response"</span>, newLV <span class="op">=</span> <span class="va">newLV</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">preds</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, ylab  <span class="op">=</span> <span class="st">"Predicted response"</span>, xlab <span class="op">=</span> <span class="st">"LV2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span>x0<span class="op">=</span><span class="fu"><a href="../reference/ecoCoefs.html">optima</a></span><span class="op">(</span><span class="va">ftComTol</span>, sd.errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,x1 <span class="op">=</span> <span class="fu"><a href="../reference/ecoCoefs.html">optima</a></span><span class="op">(</span><span class="va">ftComTol</span>, sd.errors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, y0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, y1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">preds</span>,<span class="fl">2</span>,<span class="va">max</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="st">"dashed"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="fu"><a href="../reference/getLV.gllvm.html">getLV</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ftComTol</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">newLV</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="va">preds</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">newLV</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="va">j</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette5_files/figure-html/curves-1.png" width="480" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-vanderVeen2021a" class="csl-entry">
Veen, B. van der, F.K.C. Hui, K.A. Hovstad, E.B. Solbu, and R.B. O’Hara.
2021. <span>“Model-Based Ordination for Species with Unequal Niche
Widths.”</span> 12: 1288–1300.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jenni Niku, Wesley Brooks, Riki Herliansyah, Francis K.C. Hui, Pekka Korhonen, Sara Taskinen, Bert van der Veen, David I. Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
