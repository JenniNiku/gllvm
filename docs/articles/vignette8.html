<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysing sparse ecological percent cover data using gllvm • gllvm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysing sparse ecological percent cover data using gllvm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gllvm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette1.html">Analysing multivariate abundance data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette2.html">Analysing high-dimensional microbial community data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette3.html">Introduction to gllvm Part 1: Ordination</a>
    </li>
    <li>
      <a href="../articles/vignette4.html">Introduction to gllvm Part 2: Species correlations</a>
    </li>
    <li>
      <a href="../articles/vignette5.html">How to use the quadratic response model</a>
    </li>
    <li>
      <a href="../articles/vignette6.html">Ordination with predictors</a>
    </li>
    <li>
      <a href="../articles/vignette7.html">Phylogenetic random effects</a>
    </li>
    <li>
      <a href="../articles/vignette8.html">Analysing sparse ecological percent cover data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette9.html">Correlation structures for latent variables and row effects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JenniNiku/gllvm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysing sparse ecological percent cover data
using gllvm</h1>
                        <h4 data-toc-skip class="author">Pekka
Korhonen</h4>
            
            <h4 data-toc-skip class="date">2025-07-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JenniNiku/gllvm/blob/HEAD/vignettes/vignette8.Rmd" class="external-link"><code>vignettes/vignette8.Rmd</code></a></small>
      <div class="hidden name"><code>vignette8.Rmd</code></div>

    </div>

    
    
<p>This short document showcases how to use the <strong>gllvm</strong>
package to analyse multivariate percent cover data. Namely, we show how
to apply the hurdle beta GLLVM (with logistic link), as detailed in
<span class="citation">Korhonen et al. (2024)</span>, to analyse the
kelp forest dataset from the Santa Barbara Coastal Long-Term Ecological
Research project, available from <a href="https://doi.org/10.6073/pasta/0af1a5b0d9dde5b4e5915c0012ccf99c" class="external-link">https://doi.org/10.6073/pasta/0af1a5b0d9dde5b4e5915c0012ccf99c</a>.</p>
<p>A multivariate percent cover dataset often comes in the form of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math>
matrix <span class="math inline">$\bf{Y}$</span>, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
being the number of observational units/sites, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
being the number of species of plants, macroalgae, sessile
invertebrates, et cetera. The response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
is then the recorded percentage of the relative area covered by species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
on unit/site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
Typically such datasets contain considerable proportion of zero
observations, as a given obs. unit is often populated by only a small
subset of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
species in total. More rarely, it might even be the case that one of the
species covers some obs. unit completely.</p>
<div class="section level2">
<h2 id="hurdle-beta-gllvm">Hurdle beta GLLVM<a class="anchor" aria-label="anchor" href="#hurdle-beta-gllvm"></a>
</h2>
<p>Traditionally, beta regression has been used to model responses that
take the form of percentages. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><annotation encoding="application/x-tex">y^*_{ij}</annotation></semantics></math>
is in the (open) interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,1)</annotation></semantics></math>,
and is distributed according to beta distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo>∼</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y^*_{ij} \sim \text{Beta}(\mu_{ij}, \phi_j)</annotation></semantics></math>,
then it has the following density:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mtext mathvariant="normal">beta</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo>;</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>ϕ</mi><mi>j</mi></msub><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>ϕ</mi><mi>j</mi></msub><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>ϕ</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> f_{\text{beta}}(y_{ij}^*; \mu_{ij}, \phi_j) = \frac{\Gamma(\phi_j)}{\Gamma(\mu_{ij}\phi_j)\Gamma(\phi_j-\phi_j\mu_{ij})} (y_{ij}^*)^{\mu_{ij}\phi_j-1}(1-y_{ij}^*)^{\phi_j(1-\mu_{ij}-1)}.</annotation></semantics></math></p>
<p>The mean parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{ij}</annotation></semantics></math>
can be connected to a set of covariates and latent variables through
some link function, by the equation <span class="math inline">$g(\mu_{ij})=\eta_{ij} = \beta_{0j} +
\boldsymbol{\beta}_j^\top\bf{x_i} +
\boldsymbol{\lambda}_j^\top\bf{u_i}$</span>.</p>
<p>However, such a model is ill-suited for most percent cover datasets,
due to the fact that the beta distribution isn’t capable of handling
zero (or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">100\%</annotation></semantics></math>)
responses. To make use of the beta regression model in such scenario,
one needs to use some transformation in order to ‘push’ the responses
away from the boundaries. This procedure might provide reasonable
results when the numbers of zeros or ones in the data are relatively
low. On the other hand, by transforming the zeros and ones, we might
lose some important information.</p>
<p>A more sophisticated way of tackling such issue is by considering a
zero-accommodating model, couple of which have been proposed recently.
One such model is the hurdle beta model, which models the two (can be
extended to three if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">100\%</annotation></semantics></math>
covers are recorded, see <span class="citation">Korhonen et al.
(2024)</span>) classes the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
can take, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{0\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,1)</annotation></semantics></math>,
by separate processes. Namely, the zeros are assumed to be generated by
a Bernoulli process. Conditional on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_{ij}\in(0,1)</annotation></semantics></math>,
the response is modeled using the standard beta distribution as
presented above. The likelihood function for a response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
following the hurdle beta distribution is of the form:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>;</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msubsup><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>0</mn></msubsup><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>−</mo><msubsup><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>0</mn></msubsup><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>0</mn></msubsup><mo>⋅</mo><msub><mi>f</mi><mtext mathvariant="normal">beta</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>;</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
P(Y_{ij};\mu_{ij}, \mu_{ij}^0, \phi_j) = \begin{cases}
        1-\mu_{ij}^0, &amp; Y_{ij} = 0,\\
         \mu_{ij}^0 \cdot f_{\text{beta}}(Y_{ij};\mu_{ij},\phi_j), &amp; Y_{ij} \in (0,1). \\
        \end{cases}
</annotation></semantics></math> where <span class="math inline">$g(\mu_{ij}^0) = \eta_{ij}^0 = \beta_{0j}^0 +
\bf{x_i}^\top\boldsymbol{\beta}_j^0 +
\bf{u_i}^\top\boldsymbol{\lambda}_j^0$</span> for and <span class="math inline">$g(\mu_{ij}) = \eta_{ij} = \beta_{0j} +
\bf{x_i}^\top\boldsymbol{\beta}_j +
\bf{u_i}^\top\boldsymbol{\lambda}_j$</span> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>
can be either probit or logistic link function. Note, that here, the
separate linear predictors share the same environmental covariates <span class="math inline">$\bf{x}_i$</span> and latent variable scores <span class="math inline">$\bf{u}_i$</span>, while the coefficients and
loadings are allowed to differ.</p>
<p>The <strong>gllvm</strong> package implements the hurdle beta GLLVM
with two different estimation methods available. First, accessed by the
argument <code>method="VA"</code> when calling uses a hybrid approach,
where the method of variational approximations, or VA, is applied to the
Bernoulli-process part of the data (only probit link allowed), while the
method of <strong>extended</strong> variational approximations, see
<span class="citation">Korhonen et al. (2023)</span>, is applied to the
beta distributed part. By instead specifying <code>method="EVA"</code>,
the <strong>EVA</strong> method is applied to both parts of the
likelihood.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In the following, we show how to fit the logistic hurdle beta GLLVM
using <strong>EVA</strong> on the SBC LTER marine macroalgae (i.e.,
seaweed) percent cover dataset. The data has been collected in 2000-2020
along 44 permanent transect lines along coastal southern California. We
will specify a model with two latent variables (for ordination) and will
include the rockiness of the seabed and the average number of stripes of
giant kelp as environmental covariates in the model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jenniniku.github.io/gllvm/" class="external-link">gllvm</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: TMB</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'gllvm'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     simulate</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"kelpforest"</span><span class="op">)</span></span>
<span><span class="va">Yabund</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">Xenv</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">SPinfo</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">SPinfo</span></span>
<span></span>
<span><span class="co"># Data contains both algae and sessile invertebrates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">SPinfo</span><span class="op">$</span><span class="va">GROUP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  ALGAE INVERT  PLANT </span></span>
<span><span class="co">##     61     69      2</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select only the macroalgae:</span></span>
<span><span class="va">Yalg</span> <span class="op">&lt;-</span> <span class="va">Yabund</span><span class="op">[</span>,<span class="va">SPinfo</span><span class="op">$</span><span class="va">GROUP</span><span class="op">==</span><span class="st">"ALGAE"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># To demonstrate the models, use only the data from the year 2016:</span></span>
<span><span class="va">Yalg</span> <span class="op">&lt;-</span> <span class="va">Yalg</span><span class="op">[</span><span class="va">Xenv</span><span class="op">$</span><span class="va">YEAR</span><span class="op">==</span><span class="fl">2016</span>,<span class="op">]</span></span>
<span><span class="va">Xenv</span> <span class="op">&lt;-</span> <span class="va">Xenv</span><span class="op">[</span><span class="va">Xenv</span><span class="op">$</span><span class="va">YEAR</span><span class="op">==</span><span class="fl">2016</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove species which have no observations or just one</span></span>
<span><span class="va">Yalg</span> <span class="op">&lt;-</span> <span class="va">Yalg</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Number of obs. and species:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 44 42</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the covariates in the linear predictor</span></span>
<span><span class="va">Xformulai</span> <span class="op">=</span> <span class="op">~</span><span class="va">KELP_FRONDS</span> <span class="op">+</span> <span class="va">PERCENT_ROCKY</span></span></code></pre></div>
<p>After setting up the data, LV design and the covariates, the model is
estimated by</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Yalg</span>, X<span class="op">=</span><span class="va">Xenv</span>, formula <span class="op">=</span> <span class="va">Xformulai</span>, family <span class="op">=</span> <span class="st">"betaH"</span>, method<span class="op">=</span><span class="st">"EVA"</span>, </span>
<span>             num.lv <span class="op">=</span> <span class="fl">2</span>, link<span class="op">=</span><span class="st">"logit"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>reltol<span class="op">=</span><span class="fl">1e-12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To inspect e.g., the covariate effects, use</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">Xcoef</span></span></code></pre></div>
<pre><code><span><span class="co">##            KELP_FRONDS PERCENT_ROCKY</span></span>
<span><span class="co">## AU       -4.307914e-02 -4.770042e-03</span></span>
<span><span class="co">## BF       -1.853324e+00  7.845708e-02</span></span>
<span><span class="co">## BO        3.385302e-01 -6.147463e-02</span></span>
<span><span class="co">## BR       -6.183200e-02  2.733598e-02</span></span>
<span><span class="co">## BRA       3.260636e-01 -8.164720e-02</span></span>
<span><span class="co">## CAL      -1.385751e-01 -2.664296e-02</span></span>
<span><span class="co">## CC        9.511590e-02 -1.284133e-03</span></span>
<span><span class="co">## CF       -1.328734e-01  9.125119e-03</span></span>
<span><span class="co">## CG        3.078440e-02 -3.648815e-02</span></span>
<span><span class="co">## CO       -9.359905e-02  1.268354e-02</span></span>
<span><span class="co">## COF      -1.011786e-02  7.601417e-04</span></span>
<span><span class="co">## CP        2.168726e-02 -7.012546e-02</span></span>
<span><span class="co">## CRYP      5.176407e-05 -9.012539e-07</span></span>
<span><span class="co">## CYOS      3.569089e-02 -7.728223e-03</span></span>
<span><span class="co">## DL        1.015238e-02  1.974069e-02</span></span>
<span><span class="co">## DMH       2.028236e-01  8.550216e-03</span></span>
<span><span class="co">## DP       -7.015430e-02  7.813939e-03</span></span>
<span><span class="co">## DU       -6.720121e-01 -5.758309e-02</span></span>
<span><span class="co">## EAH       4.407580e+00 -6.136458e-02</span></span>
<span><span class="co">## EC        7.161877e-02  1.579956e-02</span></span>
<span><span class="co">## EH        6.005642e-01 -1.139467e-01</span></span>
<span><span class="co">## ER       -6.355586e-02 -2.330824e-02</span></span>
<span><span class="co">## FB        6.810655e-02  3.410612e-02</span></span>
<span><span class="co">## FTHR     -2.401967e-02 -1.913079e-02</span></span>
<span><span class="co">## GR        3.016769e-01 -1.434593e-02</span></span>
<span><span class="co">## GS       -2.410029e-01 -1.079593e-02</span></span>
<span><span class="co">## GYSP     -1.380775e-01  3.815308e-03</span></span>
<span><span class="co">## MH        8.944465e-02 -1.296316e-03</span></span>
<span><span class="co">## NIE      -1.928211e-02 -6.757693e-03</span></span>
<span><span class="co">## PH        1.408930e+00 -2.027203e-01</span></span>
<span><span class="co">## PHSE     -3.057175e-01  5.667093e-03</span></span>
<span><span class="co">## PL        1.329472e-01 -5.961618e-04</span></span>
<span><span class="co">## POLA     -3.064896e-02 -3.633384e-02</span></span>
<span><span class="co">## PRSP      1.027000e-05 -1.797908e-07</span></span>
<span><span class="co">## R         9.964480e-02  5.434407e-03</span></span>
<span><span class="co">## RAT       1.511523e-02  1.733764e-03</span></span>
<span><span class="co">## SAFU     -1.899770e+00  1.291657e-02</span></span>
<span><span class="co">## SAHO      5.056012e-01 -2.444927e-02</span></span>
<span><span class="co">## SAMU     -1.390003e-01 -4.124579e-03</span></span>
<span><span class="co">## SCCA     -4.487021e-02  5.600061e-02</span></span>
<span><span class="co">## TALE      6.318130e-02 -2.708912e-02</span></span>
<span><span class="co">## UV       -8.435144e-01 -4.078454e-02</span></span>
<span><span class="co">## H01_AU   -3.748890e-01 -5.090408e-02</span></span>
<span><span class="co">## H01_BF   -1.866961e-01 -7.874489e-02</span></span>
<span><span class="co">## H01_BO    2.899801e-01 -2.869145e-02</span></span>
<span><span class="co">## H01_BR   -9.661864e-02 -4.595573e-03</span></span>
<span><span class="co">## H01_BRA   1.603470e-02 -4.446664e-02</span></span>
<span><span class="co">## H01_CAL  -2.177546e-01  1.126573e-01</span></span>
<span><span class="co">## H01_CC   -1.822890e-01  5.703762e-03</span></span>
<span><span class="co">## H01_CF   -4.843186e-02 -1.332073e-02</span></span>
<span><span class="co">## H01_CG    8.040600e-02  2.046815e-01</span></span>
<span><span class="co">## H01_CO    3.978075e-02 -1.539441e-02</span></span>
<span><span class="co">## H01_COF  -2.497741e+00  2.305096e-01</span></span>
<span><span class="co">## H01_CP   -8.467667e-02  1.275048e-01</span></span>
<span><span class="co">## H01_CRYP -3.409764e-02 -7.639185e-02</span></span>
<span><span class="co">## H01_CYOS  1.091321e-01 -1.693727e-02</span></span>
<span><span class="co">## H01_DL   -2.191145e-02 -2.713931e-02</span></span>
<span><span class="co">## H01_DMH  -1.525665e-01 -1.979245e-02</span></span>
<span><span class="co">## H01_DP   -8.902506e-02  1.617001e-02</span></span>
<span><span class="co">## H01_DU   -4.162051e-01  2.109371e-01</span></span>
<span><span class="co">## H01_EAH  -7.180904e+00  1.875275e-01</span></span>
<span><span class="co">## H01_EC    4.734169e-01  1.351968e-01</span></span>
<span><span class="co">## H01_EH    1.692431e-01 -4.020182e-02</span></span>
<span><span class="co">## H01_ER   -3.849820e-02  4.543815e-02</span></span>
<span><span class="co">## H01_FB   -6.363853e-01 -2.517973e-02</span></span>
<span><span class="co">## H01_FTHR -4.713358e-01 -4.440901e-02</span></span>
<span><span class="co">## H01_GR   -1.897726e-01  2.503153e-01</span></span>
<span><span class="co">## H01_GS   -6.117867e-01 -2.390469e-01</span></span>
<span><span class="co">## H01_GYSP -3.032503e-02  1.165265e-02</span></span>
<span><span class="co">## H01_MH    7.628570e+00 -4.105026e-02</span></span>
<span><span class="co">## H01_NIE   3.543694e-01 -7.125865e-02</span></span>
<span><span class="co">## H01_PH    4.427246e-01 -8.603485e-02</span></span>
<span><span class="co">## H01_PHSE -2.351648e-01 -5.932135e-02</span></span>
<span><span class="co">## H01_PL   -1.886402e-02  2.216514e-03</span></span>
<span><span class="co">## H01_POLA -1.500098e-01 -2.585375e-02</span></span>
<span><span class="co">## H01_PRSP -6.698110e-02 -1.248328e-02</span></span>
<span><span class="co">## H01_R    -1.302328e-01  1.389499e-02</span></span>
<span><span class="co">## H01_RAT  -1.119953e-01  2.415576e-02</span></span>
<span><span class="co">## H01_SAFU -3.568917e+00 -1.324343e-01</span></span>
<span><span class="co">## H01_SAHO -2.594287e+00  1.884425e-01</span></span>
<span><span class="co">## H01_SAMU -7.460319e-02 -1.506395e-03</span></span>
<span><span class="co">## H01_SCCA -9.201648e-02  1.441938e-02</span></span>
<span><span class="co">## H01_TALE -5.933011e-01  2.266302e-01</span></span>
<span><span class="co">## H01_UV   -7.410063e-01 -1.454605e-02</span></span></code></pre>
<p>In the above, the prefix indicates that the coefficient relates to
the Bernoulli part of the hurdle model.</p>
<p>Ordination plot can then be generated as per usual:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ordiplot.gllvm.html">ordiplot</a></span><span class="op">(</span><span class="va">fit</span>, jitter <span class="op">=</span> <span class="cn">TRUE</span>, s.cex <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette8_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="ordered-beta-gllvm">Ordered beta GLLVM<a class="anchor" aria-label="anchor" href="#ordered-beta-gllvm"></a>
</h2>
<p>Another solution for modeling percentage cover data in gllvm is to
use ordered beta response model. It handles zeros and ones slightly
differently compared to hurdle beta model. Instead of assuming that the
zeros and ones comes from separate process from the percent cover, the
model assumes that there is an underlying process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">z_{ij}</annotation></semantics></math>
where all observations comes from.</p>
<p>For species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">j = 1, . . . , m</annotation></semantics></math>,
let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">z_{ij}</annotation></semantics></math>
denote an underlying continuous variable, and define two cutoff
parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ζ</mi><mrow><mi>j</mi><mn>0</mn></mrow></msub><mo>&lt;</mo><msub><mi>ζ</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\zeta_{j0} &lt; \zeta_{j1}</annotation></semantics></math>
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">Y_{ij} = 0</annotation></semantics></math>
occurs when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>ζ</mi><mrow><mi>j</mi><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">z_{ij} &lt; \zeta_{j0}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Y_{ij}=1</annotation></semantics></math>
occurs when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&gt;</mo><msub><mi>ζ</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">z_{ij}&gt;\zeta_{j1}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{ij} \in (0,1)</annotation></semantics></math>
occurs when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ζ</mi><mrow><mi>j</mi><mn>0</mn></mrow></msub><mo>&lt;</mo><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>ζ</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\zeta_{j0} &lt; z_{ij} &lt; \zeta_{j1}</annotation></semantics></math>.
Conditional on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_{ij} \in (0,1)</annotation></semantics></math>,
the response variable follows a beta distribution. By assuming
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">z_{ij}</annotation></semantics></math>
follows a logistic distribution, then marginalising over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">z_{ij}</annotation></semantics></math>
we obtain the following distribution for the percent cover responses
that characterizes the ordered beta GLLVM,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>;</mo><msub><mi>η</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>ρ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>0</mn></msubsup><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ρ</mi><mn>1</mn></msup><mo>−</mo><msup><mi>ρ</mi><mn>0</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>f</mi><mtext mathvariant="normal">beta</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>;</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>−</mo><msubsup><mi>ρ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>1</mn></msubsup><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr></mtable></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    P(Y_{ij};\eta_{ij}, \phi_j) = 
    \begin{cases}
       \rho^0_{ij}, &amp; if  Y_{ij} = 0 ,\\
        \left(\rho^1 - \rho^0 \right) \cdot f_{\text{beta}}(Y_{ij}; \mu_{ij}, \phi_j), &amp; if  Y_{ij} \in (0,1) ,\\
        1-\rho^1_{ij}, &amp; if  Y_{ij} = 1 ,\\
        \end{cases}
\end{align}</annotation></semantics></math></p>
<div class="section level3">
<h3 id="adjusting-ordered-beta-to-data-without-ones">Adjusting ordered beta to data without ones<a class="anchor" aria-label="anchor" href="#adjusting-ordered-beta-to-data-without-ones"></a>
</h3>
<p>Lets demonstrate the ordered beta response model for the previous
example. As the data has no ones:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Yalg</span> <span class="op">==</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<p>We can accommodate the model to better handle data that by fixing the
upper cutoff parameters to some large value, for example 20. With
<em>gllvm</em> this can be done by setting starting values for the
cutoff parameter, ´zetacutoff = c(0, 20)´ and fixing the upper cutoff
parameters with ´setMap = list(zeta = factor(c(1:m, rep(NA, m))))´. We
assume that the number of species/response variables in the data is
saved to object <code>m</code>. There are ´m´ (number of species) lower
cutoff parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mi>j</mi><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">\zeta_{j0}</annotation></semantics></math>
we let be freely estimated (that’s indexes ´1:m´ in ´setMap´) and ´m´
upper cutoff parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ζ</mi><mrow><mi>j</mi><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\zeta_{j1}</annotation></semantics></math>
that we fix (that’s ´rep(NA, m)´ in ´setMap´).</p>
</div>
<div class="section level3">
<h3 id="setting-shape-parameter-to-common-across-species">Setting shape parameter to common across species<a class="anchor" aria-label="anchor" href="#setting-shape-parameter-to-common-across-species"></a>
</h3>
<p>Some species are observed only a few times:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   AU   BF   BO   BR  BRA  CAL   CC   CF   CG   CO  COF   CP CRYP CYOS   DL  DMH </span></span>
<span><span class="co">##   23    3   11    5    2    5   30   13    5   24    5    3    3   33   26    8 </span></span>
<span><span class="co">##   DP   DU  EAH   EC   EH   ER   FB FTHR   GR   GS GYSP   MH  NIE   PH PHSE   PL </span></span>
<span><span class="co">##   14    4    3   36    2    6    6    6   11   20    7   36   13    2    5    4 </span></span>
<span><span class="co">## POLA PRSP    R  RAT SAFU SAHO SAMU SCCA TALE   UV </span></span>
<span><span class="co">##    6    4   31   17    6    2    7    7    5    6</span></span></code></pre>
<p>so there is not much information to estimate the shape parameter of
the beta distribution for each species separately. Thus we can also set
the shape parameter to be common across species with ´disp.formula =
rep(1, m)´. This can be applied for all beta based models in
<em>gllvm</em>.</p>
</div>
<div class="section level3">
<h3 id="model-fit">Model fit<a class="anchor" aria-label="anchor" href="#model-fit"></a>
</h3>
<p>Now we are ready to fit the model, we use probit-link function here
but logit is also possible similarly to beta hurdle model:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># save the number of species to object m</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">)</span></span>
<span><span class="va">fit_ob</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Yalg</span>, X<span class="op">=</span><span class="va">Xenv</span>, formula <span class="op">=</span> <span class="va">Xformulai</span>, family <span class="op">=</span> <span class="st">"orderedBeta"</span>, </span>
<span>    method<span class="op">=</span><span class="st">"EVA"</span>, num.lv <span class="op">=</span> <span class="fl">2</span>, link<span class="op">=</span><span class="st">"probit"</span>,</span>
<span>    disp.formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">m</span><span class="op">)</span>, zetacutoff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>    setMap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>zeta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_ob</span></span></code></pre></div>
<pre><code><span><span class="co">## Call: </span></span>
<span><span class="co">## gllvm(y = Yalg, X = Xenv, formula = Xformulai, family = "orderedBeta", </span></span>
<span><span class="co">##     num.lv = 2, method = "EVA", link = "probit", disp.formula = rep(1, </span></span>
<span><span class="co">##         m), setMap = list(zeta = factor(c(1:m, rep(NA, m)))), </span></span>
<span><span class="co">##     zetacutoff = c(0, 20))</span></span>
<span><span class="co">## family: </span></span>
<span><span class="co">## [1] "orderedBeta"</span></span>
<span><span class="co">## method: </span></span>
<span><span class="co">## [1] "EVA"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## log-likelihood:  265.8511 </span></span>
<span><span class="co">## Residual degrees of freedom:  1554 </span></span>
<span><span class="co">## AIC:  56.29774 </span></span>
<span><span class="co">## AICc:  167.9912 </span></span>
<span><span class="co">## BIC:  1679.724</span></span></code></pre>
<p>Now if we check the cutoff values we see that the upper bounds are
fixed to 20</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_ob</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">zeta</span></span></code></pre></div>
<pre><code><span><span class="co">##          cutoff0 cutoff1</span></span>
<span><span class="co">##  [1,] -2.2804694      20</span></span>
<span><span class="co">##  [2,] -1.2916900      20</span></span>
<span><span class="co">##  [3,] -2.7331047      20</span></span>
<span><span class="co">##  [4,] -1.5286385      20</span></span>
<span><span class="co">##  [5,] -1.5029773      20</span></span>
<span><span class="co">##  [6,] -2.1640885      20</span></span>
<span><span class="co">##  [7,] -5.4648841      20</span></span>
<span><span class="co">##  [8,] -3.0017473      20</span></span>
<span><span class="co">##  [9,] -3.6935325      20</span></span>
<span><span class="co">## [10,] -3.4401731      20</span></span>
<span><span class="co">## [11,] -5.3251816      20</span></span>
<span><span class="co">## [12,] -3.3384571      20</span></span>
<span><span class="co">## [13,] -1.5552542      20</span></span>
<span><span class="co">## [14,] -3.6606665      20</span></span>
<span><span class="co">## [15,] -3.4961040      20</span></span>
<span><span class="co">## [16,] -2.4117584      20</span></span>
<span><span class="co">## [17,] -2.3677207      20</span></span>
<span><span class="co">## [18,] -2.3543442      20</span></span>
<span><span class="co">## [19,] -5.6424235      20</span></span>
<span><span class="co">## [20,] -4.2557158      20</span></span>
<span><span class="co">## [21,] -2.8684617      20</span></span>
<span><span class="co">## [22,] -2.7467919      20</span></span>
<span><span class="co">## [23,] -0.8132517      20</span></span>
<span><span class="co">## [24,] -2.3837258      20</span></span>
<span><span class="co">## [25,] -4.5109361      20</span></span>
<span><span class="co">## [26,] -3.5332852      20</span></span>
<span><span class="co">## [27,] -2.0539203      20</span></span>
<span><span class="co">## [28,] -4.3952734      20</span></span>
<span><span class="co">## [29,] -3.1997388      20</span></span>
<span><span class="co">## [30,] -1.5218883      20</span></span>
<span><span class="co">## [31,] -2.3919245      20</span></span>
<span><span class="co">## [32,] -1.7326184      20</span></span>
<span><span class="co">## [33,] -2.2156611      20</span></span>
<span><span class="co">## [34,] -2.1988386      20</span></span>
<span><span class="co">## [35,] -4.8337851      20</span></span>
<span><span class="co">## [36,] -3.3171903      20</span></span>
<span><span class="co">## [37,] -4.6105558      20</span></span>
<span><span class="co">## [38,] -8.5070934      20</span></span>
<span><span class="co">## [39,] -1.6002892      20</span></span>
<span><span class="co">## [40,] -2.3137990      20</span></span>
<span><span class="co">## [41,] -3.0606793      20</span></span>
<span><span class="co">## [42,] -1.6685450      20</span></span></code></pre>
<p>Ordination plot:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ordiplot.gllvm.html">ordiplot</a></span><span class="op">(</span><span class="va">fit_ob</span>, jitter <span class="op">=</span> <span class="cn">TRUE</span>, s.cex <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette8_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Korhonen2023" class="csl-entry">
Korhonen, P., F.K.C. Hui, J. Niku, and S. Taskinen. 2023. <span>“Fast
and Universal Estimation of Latent Variable Models Using Extended
Variational Approximations.”</span> 33: 26. <a href="https://doi.org/10.1007/s11222-022-10189-w" class="external-link">https://doi.org/10.1007/s11222-022-10189-w</a>.
</div>
<div id="ref-Korhonen2024" class="csl-entry">
Korhonen, P., F.K.C. Hui, J. Niku, S. Taskinen, and B. van der Veen.
2024. <span>“A Comparison of Joint Species Distribution Models for
Percent Cover Data.”</span> <a href="https://doi.org/10.48550/arXiv.2403.11562" class="external-link">https://doi.org/10.48550/arXiv.2403.11562</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenni Niku, Wesley Brooks, Riki Herliansyah, Francis K.C. Hui, Pekka Korhonen, Sara Taskinen, Bert van der Veen, David I. Warton.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
