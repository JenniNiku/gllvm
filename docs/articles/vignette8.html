<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysing sparse ecological percent cover data using gllvm • gllvm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysing sparse ecological percent cover data using gllvm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gllvm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette1.html">Analysing multivariate abundance data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette2.html">Analysing high-dimensional microbial community data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette3.html">Introduction to gllvm Part 1: Ordination</a>
    </li>
    <li>
      <a href="../articles/vignette4.html">Introduction to gllvm Part 2: Species correlations</a>
    </li>
    <li>
      <a href="../articles/vignette5.html">How to use the quadratic response model</a>
    </li>
    <li>
      <a href="../articles/vignette6.html">Ordination with predictors</a>
    </li>
    <li>
      <a href="../articles/vignette7.html">Phylogenetic random effects</a>
    </li>
    <li>
      <a href="../articles/vignette8.html">Analysing sparse ecological percent cover data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette9.html">Correlation structures for latent variables and row effects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JenniNiku/gllvm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysing sparse ecological percent cover data
using gllvm</h1>
                        <h4 data-toc-skip class="author">Pekka
Korhonen</h4>
            
            <h4 data-toc-skip class="date">2025-07-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JenniNiku/gllvm/blob/HEAD/vignettes/vignette8.Rmd" class="external-link"><code>vignettes/vignette8.Rmd</code></a></small>
      <div class="hidden name"><code>vignette8.Rmd</code></div>

    </div>

    
    
<p>This short document showcases how to use the <strong>gllvm</strong>
package to analyse multivariate percent cover data. Namely, we show how
to apply the hurdle beta GLLVM (with logistic link), as detailed in
<span class="citation">Korhonen et al. (2024)</span>, to analyse the
kelp forest dataset from the Santa Barbara Coastal Long-Term Ecological
Research project, available from <a href="https://doi.org/10.6073/pasta/0af1a5b0d9dde5b4e5915c0012ccf99c" class="external-link">https://doi.org/10.6073/pasta/0af1a5b0d9dde5b4e5915c0012ccf99c</a>.</p>
<p>A multivariate percent cover dataset often comes in the form of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n \times m</annotation></semantics></math>
matrix <span class="math inline">$\bf{Y}$</span>, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
being the number of observational units/sites, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
being the number of species of plants, macroalgae, sessile
invertebrates, et cetera. The response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
is then the recorded percentage of the relative area covered by species
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
on unit/site
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.
Typically such datasets contain considerable proportion of zero
observations, as a given obs. unit is often populated by only a small
subset of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
species in total. More rarely, it might even be the case that one of the
species covers some obs. unit completely.</p>
<div class="section level2">
<h2 id="hurdle-beta-gllvm">Hurdle beta GLLVM<a class="anchor" aria-label="anchor" href="#hurdle-beta-gllvm"></a>
</h2>
<p>Traditionally, beta regression has been used to model responses that
take the form of percentages. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><annotation encoding="application/x-tex">y^*_{ij}</annotation></semantics></math>
is in the (open) interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,1)</annotation></semantics></math>,
and is distributed according to beta distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo>∼</mo><mtext mathvariant="normal">Beta</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y^*_{ij} \sim \text{Beta}(\mu_{ij}, \phi_j)</annotation></semantics></math>,
then it has the following density:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mtext mathvariant="normal">beta</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo>;</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>ϕ</mi><mi>j</mi></msub><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>ϕ</mi><mi>j</mi></msub><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>ϕ</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> f_{\text{beta}}(y_{ij}^*; \mu_{ij}, \phi_j) = \frac{\Gamma(\phi_j)}{\Gamma(\mu_{ij}\phi_j)\Gamma(\phi_j-\phi_j\mu_{ij})} (y_{ij}^*)^{\mu_{ij}\phi_j-1}(1-y_{ij}^*)^{\phi_j(1-\mu_{ij}-1)}.</annotation></semantics></math></p>
<p>The mean parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\mu_{ij}</annotation></semantics></math>
can be connected to a set of covariates and latent variables through
some link function, by the equation <span class="math inline">$g(\mu_{ij})=\eta_{ij} = \beta_{0j} +
\boldsymbol{\beta}_j^\top\bf{x_i} +
\boldsymbol{\lambda}_j^\top\bf{u_i}$</span>.</p>
<p>However, such a model is ill-suited for most percent cover datasets,
due to the fact that the beta distribution isn’t capable of handling
zero (or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">100\%</annotation></semantics></math>)
responses. To make use of the beta regression model in such scenario,
one needs to use some transformation in order to ‘push’ the responses
away from the boundaries. This procedure might provide reasonable
results when the numbers of zeros or ones in the data are relatively
low. On the other hand, by transforming the zeros and ones, we might
lose some important information.</p>
<p>A more sophisticated way of tackling such issue is by considering a
zero-accommodating model, couple of which have been proposed recently.
One such model is the hurdle beta model, which models the two (can be
extended to three if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">100\%</annotation></semantics></math>
covers are recorded, see <span class="citation">Korhonen et al.
(2024)</span>) classes the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">y_{ij}</annotation></semantics></math>
can take, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{0\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0,1)</annotation></semantics></math>,
by separate processes. Namely, the zeros are assumed to be generated by
a Bernoulli process. Conditional on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">y_{ij}\in(0,1)</annotation></semantics></math>,
the response is modeled using the standard beta distribution as
presented above. The likelihood function for a response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">Y_{ij}</annotation></semantics></math>
following the hurdle beta distribution is of the form:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>;</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msubsup><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>0</mn></msubsup><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn><mo>−</mo><msubsup><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>0</mn></msubsup><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>0</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msubsup><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>0</mn></msubsup><mo>⋅</mo><msub><mi>f</mi><mtext mathvariant="normal">beta</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>;</mo><msub><mi>μ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><msub><mi>ϕ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"><msub><mi>Y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
P(Y_{ij};\mu_{ij}, \mu_{ij}^0, \phi_j) = \begin{cases}
        1-\mu_{ij}^0, &amp; Y_{ij} = 0,\\
         \mu_{ij}^0 \cdot f_{\text{beta}}(Y_{ij};\mu_{ij},\phi_j), &amp; Y_{ij} \in (0,1). \\
        \end{cases}
</annotation></semantics></math> where <span class="math inline">$g(\mu_{ij}^0) = \eta_{ij}^0 = \beta_{0j}^0 +
\bf{x_i}^\top\boldsymbol{\beta}_j^0 +
\bf{u_i}^\top\boldsymbol{\lambda}_j^0$</span> for and <span class="math inline">$g(\mu_{ij}) = \eta_{ij} = \beta_{0j} +
\bf{x_i}^\top\boldsymbol{\beta}_j +
\bf{u_i}^\top\boldsymbol{\lambda}_j$</span> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(\cdot)</annotation></semantics></math>
can be either probit or logistic link function. Note, that here, the
separate linear predictors share the same environmental covariates <span class="math inline">$\bf{x}_i$</span> and latent variable scores <span class="math inline">$\bf{u}_i$</span>, while the coefficients and
loadings are allowed to differ.</p>
<p>The <strong>gllvm</strong> package implements the hurdle beta GLLVM
with two different estimation methods available. First, accessed by the
argument <code>method="VA"</code> when calling uses a hybrid approach,
where the method of variational approximations, or VA, is applied to the
Bernoulli-process part of the data (only probit link allowed), while the
method of <strong>extended</strong> variational approximations, see
<span class="citation">Korhonen et al. (2023)</span>, is applied to the
beta distributed part. By instead specifying <code>method="EVA"</code>,
the <strong>EVA</strong> method is applied to both parts of the
likelihood.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In the following, we show how to fit the logistic hurdle beta GLLVM
using <strong>EVA</strong> on the SBC LTER marine macroalgae (i.e.,
seaweed) percent cover dataset. The data has been collected in 2000-2020
along 44 permanent transect lines along coastal southern California. We
will specify a model with two latent variables (for ordination) and will
include the rockiness of the seabed and the average number of stripes of
giant kelp as environmental covariates in the model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jenniniku.github.io/gllvm/" class="external-link">gllvm</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: TMB</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'gllvm'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     simulate</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"kelpforest"</span><span class="op">)</span></span>
<span><span class="va">Yabund</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">Xenv</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">X</span></span>
<span><span class="va">SPinfo</span> <span class="op">&lt;-</span> <span class="va">kelpforest</span><span class="op">$</span><span class="va">SPinfo</span></span>
<span></span>
<span><span class="co"># Data contains both algae and sessile invertebrates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">SPinfo</span><span class="op">$</span><span class="va">GROUP</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  ALGAE INVERT  PLANT </span></span>
<span><span class="co">##     61     69      2</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select only the macroalgae:</span></span>
<span><span class="va">Yalg</span> <span class="op">&lt;-</span> <span class="va">Yabund</span><span class="op">[</span>,<span class="va">SPinfo</span><span class="op">$</span><span class="va">GROUP</span><span class="op">==</span><span class="st">"ALGAE"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove empty rows and rows with missing values from the data</span></span>
<span><span class="va">rem0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Yalg</span> <span class="op">&lt;-</span> <span class="va">Yalg</span><span class="op">[</span><span class="op">-</span><span class="va">rem0</span>,<span class="op">]</span></span>
<span><span class="va">Xenv</span> <span class="op">&lt;-</span> <span class="va">Xenv</span><span class="op">[</span><span class="op">-</span><span class="va">rem0</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Use only the data from the year 2016:</span></span>
<span></span>
<span><span class="va">Yalg</span> <span class="op">&lt;-</span> <span class="va">Yalg</span><span class="op">[</span><span class="va">Xenv</span><span class="op">$</span><span class="va">YEAR</span><span class="op">==</span><span class="fl">2016</span>,<span class="op">]</span></span>
<span><span class="va">Xenv</span> <span class="op">&lt;-</span> <span class="va">Xenv</span><span class="op">[</span><span class="va">Xenv</span><span class="op">$</span><span class="va">YEAR</span><span class="op">==</span><span class="fl">2016</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove species which have no observations</span></span>
<span><span class="va">Yalg</span> <span class="op">&lt;-</span> <span class="va">Yalg</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Number of obs. and species:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Yalg</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 44 53</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify the covariates in the linear predictor</span></span>
<span><span class="va">Xformulai</span> <span class="op">=</span> <span class="op">~</span><span class="va">KELP_FRONDS</span> <span class="op">+</span> <span class="va">PERCENT_ROCKY</span></span></code></pre></div>
<p>After setting up the data, LV design and the covariates, the model is
estimated by</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">Yalg</span>, X<span class="op">=</span><span class="va">Xenv</span>, formula <span class="op">=</span> <span class="va">Xformulai</span>, family <span class="op">=</span> <span class="st">"betaH"</span>, method<span class="op">=</span><span class="st">"EVA"</span>, </span>
<span>             num.lv <span class="op">=</span> <span class="fl">2</span>, link<span class="op">=</span><span class="st">"logit"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>reltol<span class="op">=</span><span class="fl">1e-12</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To inspect e.g., the covariate effects, use</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">Xcoef</span></span></code></pre></div>
<pre><code><span><span class="co">##            KELP_FRONDS PERCENT_ROCKY</span></span>
<span><span class="co">## AMZO     -6.414759e-04  -0.031667796</span></span>
<span><span class="co">## AU       -1.429881e-01   0.054856810</span></span>
<span><span class="co">## BF       -2.222402e+00   0.047593908</span></span>
<span><span class="co">## BLD      -1.012555e-02  -0.150436710</span></span>
<span><span class="co">## BO        7.988108e-01  -0.084553191</span></span>
<span><span class="co">## BR        2.682455e-01   0.019632366</span></span>
<span><span class="co">## BRA      -5.412418e-02  -0.061019703</span></span>
<span><span class="co">## CAL      -2.096637e-01  -0.053323764</span></span>
<span><span class="co">## CC        9.203757e-02  -0.020141723</span></span>
<span><span class="co">## CF       -1.800648e-01   0.061331617</span></span>
<span><span class="co">## CG        9.176557e-01  -0.055644998</span></span>
<span><span class="co">## CO       -1.982017e-01   0.026593262</span></span>
<span><span class="co">## COF       2.819400e-01  -0.004842634</span></span>
<span><span class="co">## CP        6.393406e-01  -0.042999800</span></span>
<span><span class="co">## CRYP      1.828712e+00   0.007145965</span></span>
<span><span class="co">## CYOS      2.099581e-01  -0.041734426</span></span>
<span><span class="co">## CZ       -4.788803e-03  -0.088887286</span></span>
<span><span class="co">## DL        3.763774e-01  -0.049474343</span></span>
<span><span class="co">## DMH      -9.546725e-01   0.027608265</span></span>
<span><span class="co">## DP       -2.819757e-01  -0.018594380</span></span>
<span><span class="co">## DU       -7.363924e-02  -0.007471000</span></span>
<span><span class="co">## EAH       8.587598e+00  -0.025932921</span></span>
<span><span class="co">## EC        7.828564e-02   0.011818169</span></span>
<span><span class="co">## EH        1.188374e-01  -0.108121060</span></span>
<span><span class="co">## ER       -5.499829e-01  -0.026073576</span></span>
<span><span class="co">## FASP     -1.548967e-03  -0.049881983</span></span>
<span><span class="co">## FB        1.521047e+00   0.038471820</span></span>
<span><span class="co">## FTHR     -8.249420e-01   0.059991213</span></span>
<span><span class="co">## GR        1.787073e-01  -0.034111070</span></span>
<span><span class="co">## GS       -1.930287e+00   0.040674291</span></span>
<span><span class="co">## GYSP      5.219380e-01  -0.113931956</span></span>
<span><span class="co">## IR       -1.015278e-03  -0.037875667</span></span>
<span><span class="co">## LH       -2.592421e-03  -0.035634651</span></span>
<span><span class="co">## LI        2.926986e-04   0.263428710</span></span>
<span><span class="co">## LS       -8.906518e-03  -0.125223450</span></span>
<span><span class="co">## LX       -1.613055e-02  -0.216470580</span></span>
<span><span class="co">## MH        3.728082e-01  -0.015549624</span></span>
<span><span class="co">## NIE      -1.202642e-01  -0.027218067</span></span>
<span><span class="co">## PH        1.676493e+00  -0.278784906</span></span>
<span><span class="co">## PHSE     -1.443997e-02   0.026282318</span></span>
<span><span class="co">## PL       -1.762481e-01   0.024380975</span></span>
<span><span class="co">## POLA     -7.222893e-01  -0.007268270</span></span>
<span><span class="co">## PRSP      1.130181e+00  -0.027893744</span></span>
<span><span class="co">## R         3.158731e-01   0.043833710</span></span>
<span><span class="co">## RAT      -6.288062e-01   0.026223457</span></span>
<span><span class="co">## SAFU      2.452626e+00  -0.084268000</span></span>
<span><span class="co">## SAHO     -7.351259e-01   0.022324266</span></span>
<span><span class="co">## SAMU      1.665675e-01  -0.019095955</span></span>
<span><span class="co">## SCCA      3.330960e-02   0.111233546</span></span>
<span><span class="co">## STIN     -6.422117e-05  -0.057799053</span></span>
<span><span class="co">## TALE     -6.470602e-01  -0.017442143</span></span>
<span><span class="co">## UEC      -4.952136e-05  -0.024760680</span></span>
<span><span class="co">## UV        1.169486e+00  -0.107982466</span></span>
<span><span class="co">## H01_AMZO  2.243470e+00  -0.065169665</span></span>
<span><span class="co">## H01_AU   -7.144139e-01  -0.011080315</span></span>
<span><span class="co">## H01_BF   -9.677637e-01  -0.015704696</span></span>
<span><span class="co">## H01_BLD  -6.385458e-01   0.035004673</span></span>
<span><span class="co">## H01_BO    3.737361e-01  -0.038988348</span></span>
<span><span class="co">## H01_BR   -5.062432e-01   0.034880408</span></span>
<span><span class="co">## H01_BRA  -1.450563e+00   0.127720865</span></span>
<span><span class="co">## H01_CAL   8.895561e-02   0.160057833</span></span>
<span><span class="co">## H01_CC    1.081214e+00  -0.069387989</span></span>
<span><span class="co">## H01_CF    1.900629e+00  -0.154116956</span></span>
<span><span class="co">## H01_CG    2.652004e+00   0.013307152</span></span>
<span><span class="co">## H01_CO    3.984345e-01  -0.021280093</span></span>
<span><span class="co">## H01_COF   5.208187e-01   0.150036340</span></span>
<span><span class="co">## H01_CP   -2.106989e+00   0.170146298</span></span>
<span><span class="co">## H01_CRYP -1.515659e+00   0.060666487</span></span>
<span><span class="co">## H01_CYOS -1.514434e+00   0.083313361</span></span>
<span><span class="co">## H01_CZ   -2.648821e-01   0.133230867</span></span>
<span><span class="co">## H01_DL    3.647576e-01  -0.025484156</span></span>
<span><span class="co">## H01_DMH  -1.885604e+00   0.101960376</span></span>
<span><span class="co">## H01_DP    1.126203e+00  -0.048427541</span></span>
<span><span class="co">## H01_DU   -2.824181e+00   0.166558965</span></span>
<span><span class="co">## H01_EAH  -1.206518e+01   0.092527522</span></span>
<span><span class="co">## H01_EC   -1.066875e+00   0.139770775</span></span>
<span><span class="co">## H01_EH   -7.361457e-01   0.015708696</span></span>
<span><span class="co">## H01_ER   -2.510731e-01   0.062931800</span></span>
<span><span class="co">## H01_FASP -4.702653e-01   0.132828607</span></span>
<span><span class="co">## H01_FB    2.141098e-01  -0.040687842</span></span>
<span><span class="co">## H01_FTHR -5.646436e-01   0.008388668</span></span>
<span><span class="co">## H01_GR   -9.135560e-01   0.291659904</span></span>
<span><span class="co">## H01_GS    5.765959e-01  -0.287425984</span></span>
<span><span class="co">## H01_GYSP -1.555153e+00   0.104374579</span></span>
<span><span class="co">## H01_IR    3.454545e-01   0.103177043</span></span>
<span><span class="co">## H01_LH   -2.095577e+00   0.180935717</span></span>
<span><span class="co">## H01_LI   -8.050576e+00   0.015719458</span></span>
<span><span class="co">## H01_LS   -1.164744e+00   0.112298781</span></span>
<span><span class="co">## H01_LX    9.683870e-01  -0.133361137</span></span>
<span><span class="co">## H01_MH   -2.363341e+00   0.149731293</span></span>
<span><span class="co">## H01_NIE  -1.339358e+00   0.078269381</span></span>
<span><span class="co">## H01_PH   -6.717199e-02  -0.063048673</span></span>
<span><span class="co">## H01_PHSE  5.077001e-01  -0.098741834</span></span>
<span><span class="co">## H01_PL   -8.218807e-01   0.051110199</span></span>
<span><span class="co">## H01_POLA -1.734991e+00   0.075440347</span></span>
<span><span class="co">## H01_PRSP -1.029324e+00   0.021467787</span></span>
<span><span class="co">## H01_R     3.694302e-01  -0.020476165</span></span>
<span><span class="co">## H01_RAT  -3.477286e-01   0.038485109</span></span>
<span><span class="co">## H01_SAFU -3.705048e+00  -0.071834460</span></span>
<span><span class="co">## H01_SAHO -6.616918e+00   0.109438215</span></span>
<span><span class="co">## H01_SAMU  9.968886e-01  -0.051707512</span></span>
<span><span class="co">## H01_SCCA  4.777883e-01   0.004877998</span></span>
<span><span class="co">## H01_STIN -1.156252e+01   0.106900683</span></span>
<span><span class="co">## H01_TALE -3.129780e+00   0.194513617</span></span>
<span><span class="co">## H01_UEC  -3.841322e+00   0.114540931</span></span>
<span><span class="co">## H01_UV    1.392082e-01   0.007336603</span></span></code></pre>
<p>In the above, the prefix indicates that the coefficient relates to
the Bernoulli part of the hurdle model.</p>
<p>Ordination plot can then be generated as per usual:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ordiplot.gllvm.html">ordiplot</a></span><span class="op">(</span><span class="va">fit</span>, jitter <span class="op">=</span> <span class="cn">TRUE</span>, s.cex <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette8_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Korhonen2023" class="csl-entry">
Korhonen, P., F.K.C. Hui, J. Niku, and S. Taskinen. 2023. <span>“Fast
and Universal Estimation of Latent Variable Models Using Extended
Variational Approximations.”</span> 33: 26. <a href="https://doi.org/10.1007/s11222-022-10189-w" class="external-link">https://doi.org/10.1007/s11222-022-10189-w</a>.
</div>
<div id="ref-Korhonen2024" class="csl-entry">
Korhonen, P., F.K.C. Hui, J. Niku, S. Taskinen, and B. van der Veen.
2024. <span>“A Comparison of Joint Species Distribution Models for
Percent Cover Data.”</span> <a href="https://doi.org/10.48550/arXiv.2403.11562" class="external-link">https://doi.org/10.48550/arXiv.2403.11562</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jenni Niku, Wesley Brooks, Riki Herliansyah, Francis K.C. Hui, Pekka Korhonen, Sara Taskinen, Bert van der Veen, David I. Warton.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
