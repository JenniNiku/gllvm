<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot phylogenetic random effects from gllvm — phyloplot.gllvm • gllvm</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot phylogenetic random effects from gllvm — phyloplot.gllvm"><meta property="og:description" content="Plots phylogenetic random effects with the phylogeny, and community effects"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gllvm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/vignette1.html">Analysing multivariate abundance data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette2.html">Analysing high-dimensional microbial community data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette3.html">Introduction to gllvm Part 1: Ordination</a>
    </li>
    <li>
      <a href="../articles/vignette4.html">Introduction to gllvm Part 2: Species correlations</a>
    </li>
    <li>
      <a href="../articles/vignette5.html">How to use the quadratic response model</a>
    </li>
    <li>
      <a href="../articles/vignette6.html">Ordination with predictors</a>
    </li>
    <li>
      <a href="../articles/vignette7.html">Phylogenetic random effects</a>
    </li>
    <li>
      <a href="../articles/vignette8.html">Analysing sparse ecological percent cover data using gllvm</a>
    </li>
    <li>
      <a href="../articles/vignette9.html">Correlation structures for latent variables and row effects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/JenniNiku/gllvm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot phylogenetic random effects from gllvm</h1>
    <small class="dont-index">Source: <a href="https://github.com/JenniNiku/gllvm/blob/HEAD/R/phyloplot.gllvm.R" class="external-link"><code>R/phyloplot.gllvm.R</code></a></small>
    <div class="hidden name"><code>phyloplot.gllvm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plots phylogenetic random effects with the phylogeny, and community effects</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gllvm'</span></span>
<span><span class="fu">phyloplot</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">tree</span>,</span>
<span>  comm.eff <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  row.eff <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  which.Xcoef <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E69F00"</span>, <span class="st">"white"</span>, <span class="st">"#009E73"</span><span class="op">)</span>,</span>
<span>  col.sym <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tick.length <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mar.spec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  mar.phy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  mar.comm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.edge <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  pch <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>  heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.55</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.64</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  phy.place <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object of class 'gllvm'.</p></dd>


<dt id="arg-tree">tree<a class="anchor" aria-label="anchor" href="#arg-tree"></a></dt>
<dd><p>an object of class ”</p></dd>


<dt id="arg-comm-eff">comm.eff<a class="anchor" aria-label="anchor" href="#arg-comm-eff"></a></dt>
<dd><p>logical, defaults to <code>TRUE</code>. If present in the model, should community effects be plotted?</p></dd>


<dt id="arg-row-eff">row.eff<a class="anchor" aria-label="anchor" href="#arg-row-eff"></a></dt>
<dd><p>logical, defaults to <code>FALSE</code>. If present in the model, should row effects (e.g., community responses to covariates) be included?</p></dd>


<dt id="arg-which-xcoef">which.Xcoef<a class="anchor" aria-label="anchor" href="#arg-which-xcoef"></a></dt>
<dd><p>List of length 2 with names to subset the effects to plot. The first vector is for the species plot, the second for community effects.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>vector of length two. Limits for the x-axis of the caterpillar plot. Defaults to NULL, in which case the limits are chosen based on the confidence intervals.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>the confidence level. Scalar between 0 and 1.</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>vector of three colors (defaults to <code>c("#E69F00","white","#009E73")</code>) passed to <code><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></code> for species random effects.</p></dd>


<dt id="arg-col-sym">col.sym<a class="anchor" aria-label="anchor" href="#arg-col-sym"></a></dt>
<dd><p>logical, defaults to <code>TRUE</code>. Then, the color scale of the species random effects plot is symmetrical (so that zero is nearly in the middle), so that both the lower and upper limit are determined by the largest absolute value. If <code>FALSE</code>, the lower and upper limits are determined by the smallest and largest values, respectively.</p></dd>


<dt id="arg-tick-length">tick.length<a class="anchor" aria-label="anchor" href="#arg-tick-length"></a></dt>
<dd><p>numerical, defaults to 2. Length of ticks for the species-specific random effects plot.</p></dd>


<dt id="arg-mar-spec">mar.spec<a class="anchor" aria-label="anchor" href="#arg-mar-spec"></a></dt>
<dd><p>vector of length 4, which defines the margins sizes for the species random effects plot. Defaults to <code>c(3, 2, 0, 0)</code>.</p></dd>


<dt id="arg-mar-phy">mar.phy<a class="anchor" aria-label="anchor" href="#arg-mar-phy"></a></dt>
<dd><p>vector of length 4, which defines the margins sizes for plotting the phylogeny. Defaults to <code>c(0, 2, 2, 0)</code>.</p></dd>


<dt id="arg-mar-comm">mar.comm<a class="anchor" aria-label="anchor" href="#arg-mar-comm"></a></dt>
<dd><p>vector of length 4, which defines the margins sizes for the caterpillar plot. Defaults to <code>c(3, 0.5, 2, 1.5)</code>.</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>the magnification to be used for text in the plot. Defaults to 0.6.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>line thickness for the branches in the phylogeny and the confidence intervals in the caterpillar plot. Defaults to 1.</p></dd>


<dt id="arg-col-edge">col.edge<a class="anchor" aria-label="anchor" href="#arg-col-edge"></a></dt>
<dd><p>character. Color of branches in the phylogeny.</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>symbol used in the catter pillar plot. Defaults to "x".</p></dd>


<dt id="arg-heights">heights<a class="anchor" aria-label="anchor" href="#arg-heights"></a></dt>
<dd><p>vector of length two. Relative row heights, defaults to <code>c(0.55, 0.35)</code>.</p></dd>


<dt id="arg-widths">widths<a class="anchor" aria-label="anchor" href="#arg-widths"></a></dt>
<dd><p>vector of length two. Relative column widths, defaults to <code>c(0.64, 0.10)</code>.</p></dd>


<dt id="arg-phy-place">phy.place<a class="anchor" aria-label="anchor" href="#arg-phy-place"></a></dt>
<dd><p>not (yet) in use.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional not in use.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Plots phylogenetically structured random effects together with the phylogeny,
and with community-level effects (i.e., effects that are the same across species).
If standard errors have been calculated for the model, the prediction intervals for
species random effects are checked, and crossed out (i.e., displayed as white) if
they cross zero.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>van der Veen, B., O'Hara, R.B. (2024). Fast fitting of Fast fitting of phylogenetic mixed effects models. arXiv.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bert van der Veen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fungi</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">fungi</span><span class="op">$</span><span class="va">Y</span></span></span>
<span class="r-in"><span><span class="co"># Scale the predictor</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">fungi</span><span class="op">$</span><span class="va">X</span></span></span>
<span class="r-in"><span><span class="va">X</span><span class="op">[</span>,<span class="st">"DBH.CM"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="st">"DBH.CM"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="va">fungi</span><span class="op">$</span><span class="va">tree</span> <span class="co"># the tree</span></span></span>
<span class="r-in"><span><span class="va">colMat</span> <span class="op">&lt;-</span> <span class="va">fungi</span><span class="op">$</span><span class="va">C</span> <span class="co"># e.g., from ape::vcv(tree)</span></span></span>
<span class="r-in"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">fungi</span><span class="op">$</span><span class="va">dist</span> <span class="co"># e.g., from ape::cophenetic.phylo(tree)</span></span></span>
<span class="r-in"><span><span class="va">order</span> <span class="op">&lt;-</span> <span class="fu">gllvm</span><span class="fu">:::</span><span class="fu">findOrder</span><span class="op">(</span>covMat <span class="op">=</span> <span class="va">colMat</span>, distMat <span class="op">=</span> <span class="va">dist</span>, nn <span class="op">=</span> <span class="fl">15</span>,</span></span>
<span class="r-in"><span>                           order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                           decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">order</span></span></span>
<span class="r-in"><span><span class="va">order</span> <span class="op">&lt;-</span> <span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">[</span><span class="va">order</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="gllvm.html">gllvm</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y</span><span class="op">[</span>,<span class="va">order</span><span class="op">]</span>, X <span class="op">=</span> <span class="va">X</span>,</span></span>
<span class="r-in"><span>                formula <span class="op">=</span> <span class="op">~</span><span class="op">(</span><span class="va">DBH.CM</span><span class="op">|</span><span class="fl">1</span><span class="op">)</span>, beta0com <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                family <span class="op">=</span> <span class="st">"binomial"</span>, num.lv <span class="op">=</span> <span class="fl">0</span>, nn.colMat <span class="op">=</span> <span class="fl">15</span>,</span></span>
<span class="r-in"><span>                colMat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">colMat</span><span class="op">[</span><span class="va">order</span>,<span class="va">order</span><span class="op">]</span>, dist <span class="op">=</span> <span class="va">dist</span><span class="op">[</span><span class="va">order</span>,<span class="va">order</span><span class="op">]</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                colMat.rho.struct <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">phyloplot</span><span class="op">(</span><span class="va">model</span>, <span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jenni Niku, Wesley Brooks, Riki Herliansyah, Francis K.C. Hui, Pekka Korhonen, Sara Taskinen, Bert van der Veen, David I. Warton.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

