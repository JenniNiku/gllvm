<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot latent variables from gllvm model — ordiplot.gllvm • gllvm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot latent variables from gllvm model — ordiplot.gllvm"><meta name="description" content="Plots latent variables and their corresponding coefficients (biplot)."><meta property="og:description" content="Plots latent variables and their corresponding coefficients (biplot)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gllvm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette1.html">Analysing multivariate abundance data using gllvm</a></li>
    <li><a class="dropdown-item" href="../articles/vignette2.html">Analysing high-dimensional microbial community data using gllvm</a></li>
    <li><a class="dropdown-item" href="../articles/vignette3.html">Introduction to gllvm Part 1: Ordination</a></li>
    <li><a class="dropdown-item" href="../articles/vignette4.html">Introduction to gllvm Part 2: Species correlations</a></li>
    <li><a class="dropdown-item" href="../articles/vignette5.html">How to use the quadratic response model</a></li>
    <li><a class="dropdown-item" href="../articles/vignette6.html">Ordination with predictors</a></li>
    <li><a class="dropdown-item" href="../articles/vignette7.html">Phylogenetic random effects</a></li>
    <li><a class="dropdown-item" href="../articles/vignette8.html">Analysing sparse ecological percent cover data using gllvm</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JenniNiku/gllvm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot latent variables from gllvm model</h1>
      <small class="dont-index">Source: <a href="https://github.com/JenniNiku/gllvm/blob/HEAD/R/ordiplot.gllvm.R" class="external-link"><code>R/ordiplot.gllvm.R</code></a></small>
      <div class="d-none name"><code>ordiplot.gllvm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots latent variables and their corresponding coefficients (biplot).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gllvm'</span></span>
<span><span class="fu">ordiplot</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  biplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ind.spp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  which.lvs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  predict.region <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  jitter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  jitter.amount <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  s.colors <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  s.cex <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>  symbols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex.spp <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  spp.colors <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>  arrow.scale <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  arrow.spp.scale <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  arrow.ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  arrow.lty <span class="op">=</span> <span class="st">"solid"</span>,</span>
<span>  fac.center <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  spp.arrows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spp.arrows.lty <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>  cex.env <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  lab.dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  lwd.ellips <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  col.ellips <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  lty.ellips <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rotate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>an object of class 'gllvm'.</p></dd>


<dt id="arg-biplot">biplot<a class="anchor" aria-label="anchor" href="#arg-biplot"></a></dt>
<dd><p><code>TRUE</code> if both latent variables and their coefficients are plotted, <code>FALSE</code> if only latent variables.</p></dd>


<dt id="arg-ind-spp">ind.spp<a class="anchor" aria-label="anchor" href="#arg-ind-spp"></a></dt>
<dd><p>the number of response variables (usually, species) to include on the biplot. The default is none, or all if <code>biplot = TRUE</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>a numeric scalar between 0 and 1 that is used to control the relative scaling of the latent variables and their coefficients, when constructing a biplot.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>main title.</p></dd>


<dt id="arg-which-lvs">which.lvs<a class="anchor" aria-label="anchor" href="#arg-which-lvs"></a></dt>
<dd><p>indices of two latent variables to be plotted if number of the latent variables is more than 2. A vector with length of two. Defaults to <code>c(1,2)</code>.</p></dd>


<dt id="arg-predict-region">predict.region<a class="anchor" aria-label="anchor" href="#arg-predict-region"></a></dt>
<dd><p>if <code>TRUE</code> or <code>"sites"</code> prediction regions for the predicted latent variables are plotted, defaults to <code>FALSE</code>. EXTENSION UNDER DEVELOPMENT: if <code>"species"</code> uncertainty estimate regions for the estimated latent variable loadings are plotted. Works only if <code>biplot = TRUE</code>.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>level for prediction regions.</p></dd>


<dt id="arg-jitter">jitter<a class="anchor" aria-label="anchor" href="#arg-jitter"></a></dt>
<dd><p>if <code>TRUE</code>, jittering is applied on points.</p></dd>


<dt id="arg-jitter-amount">jitter.amount<a class="anchor" aria-label="anchor" href="#arg-jitter-amount"></a></dt>
<dd><p>numeric, positive value indicating an amount of jittering for each point, defaults to 0.2 (jitter range).</p></dd>


<dt id="arg-s-colors">s.colors<a class="anchor" aria-label="anchor" href="#arg-s-colors"></a></dt>
<dd><p>colors for sites</p></dd>


<dt id="arg-s-cex">s.cex<a class="anchor" aria-label="anchor" href="#arg-s-cex"></a></dt>
<dd><p>size of site labels</p></dd>


<dt id="arg-symbols">symbols<a class="anchor" aria-label="anchor" href="#arg-symbols"></a></dt>
<dd><p>logical, if <code>TRUE</code> sites are plotted using symbols, if <code>FALSE</code> (default) site numbers are used</p></dd>


<dt id="arg-cex-spp">cex.spp<a class="anchor" aria-label="anchor" href="#arg-cex-spp"></a></dt>
<dd><p>size of species labels in biplot</p></dd>


<dt id="arg-spp-colors">spp.colors<a class="anchor" aria-label="anchor" href="#arg-spp-colors"></a></dt>
<dd><p>colors for sites, defaults to <code>"blue"</code></p></dd>


<dt id="arg-arrow-scale">arrow.scale<a class="anchor" aria-label="anchor" href="#arg-arrow-scale"></a></dt>
<dd><p>positive value, to scale arrows</p></dd>


<dt id="arg-arrow-spp-scale">arrow.spp.scale<a class="anchor" aria-label="anchor" href="#arg-arrow-spp-scale"></a></dt>
<dd><p>positive value, to scale arrows of species</p></dd>


<dt id="arg-arrow-ci">arrow.ci<a class="anchor" aria-label="anchor" href="#arg-arrow-ci"></a></dt>
<dd><p>represent statistical uncertainty for arrows in constrained or concurrent ordination using confidence or prediction interval? Defaults to <code>TRUE</code></p></dd>


<dt id="arg-arrow-lty">arrow.lty<a class="anchor" aria-label="anchor" href="#arg-arrow-lty"></a></dt>
<dd><p>linetype for arrows in constrained</p></dd>


<dt id="arg-fac-center">fac.center<a class="anchor" aria-label="anchor" href="#arg-fac-center"></a></dt>
<dd><p>logical. If <code>TRUE</code> place labels for binary variables at their estimated location.</p></dd>


<dt id="arg-spp-arrows">spp.arrows<a class="anchor" aria-label="anchor" href="#arg-spp-arrows"></a></dt>
<dd><p>plot species scores as arrows if outside of the range of the plot? Defaults to <code>FALSE</code> for linear response models and <code>TRUE</code> for quadratic response models.</p></dd>


<dt id="arg-spp-arrows-lty">spp.arrows.lty<a class="anchor" aria-label="anchor" href="#arg-spp-arrows-lty"></a></dt>
<dd><p>linetype for species arrows</p></dd>


<dt id="arg-cex-env">cex.env<a class="anchor" aria-label="anchor" href="#arg-cex-env"></a></dt>
<dd><p>size of labels for arrows in constrained ordination</p></dd>


<dt id="arg-lab-dist">lab.dist<a class="anchor" aria-label="anchor" href="#arg-lab-dist"></a></dt>
<dd><p>distance between label and arrow heads. Value between 0 and 1</p></dd>


<dt id="arg-lwd-ellips">lwd.ellips<a class="anchor" aria-label="anchor" href="#arg-lwd-ellips"></a></dt>
<dd><p>line width for prediction ellipses. See graphical parameter lwd.</p></dd>


<dt id="arg-col-ellips">col.ellips<a class="anchor" aria-label="anchor" href="#arg-col-ellips"></a></dt>
<dd><p>colors for prediction ellipses.</p></dd>


<dt id="arg-lty-ellips">lty.ellips<a class="anchor" aria-label="anchor" href="#arg-lty-ellips"></a></dt>
<dd><p>line type for prediction ellipses. See graphical parameter lty.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>which type of ordination plot to construct. Options are "residual", "conditional", and "marginal". Defaults to "residual" for GLLVMs with unconstrained latent variables and "conditional" otherwise.</p></dd>


<dt id="arg-rotate">rotate<a class="anchor" aria-label="anchor" href="#arg-rotate"></a></dt>
<dd><p>logical, if <code>TRUE</code> (default) latent variables are rotated to their principal direction using singular value decomposition</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional graphical arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function constructs a scatter plot of two latent variables, i.e. an ordination plot.
Latent variables are re-rotated to their principal direction using singular value decomposition,
so that the first plotted latent variable does not have to be the first latent variable in the model.
If only one latent variable is in the fitted model, latent variables are plotted against their corresponding row indices.
The latent variables are labeled using the row index of the response matrix y.</p>
<p>Coefficients related to latent variables are plotted in the same figure with the latent
variables if <code>biplot = TRUE</code>. They are labeled using the column names of y. The number
of latent variable coefficients to be plotted can be controlled by ind.spp. An argument alpha
is used to control the relative scaling of the latent variables and their coefficients.
If <code>alpha = 0.5</code>, the latent variables and their coefficients are on the same scale.
For details for constructing a biplot, see Gabriel (1971).</p>
<p>For a quadratic response model, species optima are plotted. Any species scores that are outside the range
of the predicted site scores are not directly plotted, but their main direction is indicated with arrows instead.
This ensures that the plot remains on a reasonable scale.</p>
<p>Effects of environmental variables in constrained ordination are indicated with arrows.
If any of the arrows exceeds the range of the plot, arrows are scaled to 80<!-- % of the plot range, -->
but so that the relative contribution of predictors is maintained.
If standard errors are available in the provided model, the slopes of environmental variables
for which the 95<!-- % confidence intervals do not include zero are shown as red, while others  -->
are slightly less intensely coloured.</p>
<p>For constrained ordination, a conditional plot includes both fixed- and random-effects to
optimally represent species co-occurrence patterns, corresponding to "conditional" site scores in <code><a href="getLV.gllvm.html">getLV.gllvm</a></code>.
Marginal corresponds to an ordination plot that excludes residual patterns (i.e. excluding the random-effect),
so that it is only available with num.lv.c&gt;0 or num.RR&gt;0. A conditional plot requires num.lv.c&gt;0.
The "residual" type corresponds to an ordination diagram of only residual patterns.
See <a href="getLV.gllvm.html">getLV.gllvm</a> for details.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>- If error is occurred when using <code>ordiplot()</code>, try full name of the function <code>ordiplot.gllvm()</code> as functions named 'ordiplot' might be found in other packages as well.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gabriel, K. R. (1971). The biplot graphic display of matrices with application to principal component analysis. Biometrika, 58, 453-467.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="getLV.gllvm.html">getLV.gllvm</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jenni Niku &lt;jenni.m.e.niku@jyu.fi&gt;, Francis K.C. Hui, Bert van der Veen</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#'# Extract subset of the microbial data to be used as an example</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">microbialdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">microbialdata</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">microbialdata</span><span class="op">$</span><span class="va">Y</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                     decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">21</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">y</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">$</span><span class="va">logL</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -4242.668</span>
<span class="r-in"><span><span class="fu">ordiplot</span><span class="op">(</span><span class="va">fit</span>, predict.region <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ordiplot.gllvm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">#'## Load a dataset from the mvabund package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">antTraits</span>, package <span class="op">=</span> <span class="st">"mvabund"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">antTraits</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="gllvm.html">gllvm</a></span><span class="op">(</span><span class="va">y</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Ordination plot:</span></span></span>
<span class="r-in"><span><span class="fu">ordiplot</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Biplot with 10 species</span></span></span>
<span class="r-in"><span><span class="fu">ordiplot</span><span class="op">(</span><span class="va">fit</span>, biplot <span class="op">=</span> <span class="cn">TRUE</span>, ind.spp <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jenni Niku, Wesley Brooks, Riki Herliansyah, Francis K.C. Hui, Pekka Korhonen, Sara Taskinen, Bert van der Veen, David I. Warton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

